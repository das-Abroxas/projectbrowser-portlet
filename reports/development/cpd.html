<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.8.1 from org.apache.maven.plugins:maven-pmd-plugin:3.11.0:cpd at 2019-05-27 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>ProjectBrowser Portlet &#x2013; CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
    
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">
ProjectBrowser Portlet
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2019-05-27</span>
          &nbsp;| <span id="projectVersion">Version: 1.10.0-SNAPSHOT</span>
      </div>
      <div class="xright"><a href="./" title="ProjectBrowser Portlet">ProjectBrowser Portlet</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="project-info.html" title="Project Information">Project Information</a></li>
     <li class="expanded"><a href="project-reports.html" title="Project Reports">Project Reports</a>
      <ul>
       <li class="none"><a href="checkstyle.html" title="Checkstyle">Checkstyle</a></li>
       <li class="none"><strong>CPD</strong></li>
       <li class="none"><a href="pmd.html" title="PMD">PMD</a></li>
       <li class="none"><a href="surefire-report.html" title="Surefire Report">Surefire Report</a></li>
       <li class="none"><a href="apidocs/index.html" title="Javadoc">Javadoc</a></li>
       <li class="none"><a href="jacoco/index.html" title="JaCoCo">JaCoCo</a></li>
       <li class="none"><a href="xref/index.html" title="Source Xref">Source Xref</a></li>
      </ul></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<div class="section">
<h2><a name="CPD_Results"></a>CPD Results</h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="https://pmd.github.io/latest/pmd_userdocs_cpd.html">CPD</a> 6.8.0.</p></div>
<div class="section">
<h2><a name="Duplications"></a>Duplications</h2>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L643">643</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/ProjectView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/ProjectView.html#L772">772</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            String.format(&quot;Using webId %s and companyId %d to get Portal User&quot;, webId, companyId));
      } catch (PortalException | SystemException e) {
        LOG.error(&quot;liferay error, could not retrieve companyId. Trying default companyId, which is &quot;
            + companyId, e.getStackTrace());
      }
      Set&lt;String&gt; list = datahandler.removeQBiCStaffFromMemberSet(
          datahandler.getOpenBisClient().getSpaceMembers(currentBean.getId().split(&quot;/&quot;)[1]));
      members = new TreeMap&lt;String, String&gt;();
      memberLetters = new HashMap&lt;String, String&gt;();

      // LOG.debug(list.toString());

      if (list != null) {
        memberString = new StringBuilder();
        for (String member : list) {
          User user = null;
          try {
            user = UserLocalServiceUtil.getUserByScreenName(companyId, member);
          } catch (PortalException | SystemException e) {
          }

          if (memberString.length() &gt; 0) {
            // memberString.append(&quot; , &quot;);
          }

          if (user == null) {
            LOG.warn(String.format(&quot;Openbis user %s appears to not exist in Portal&quot;, member));
            // memberString.append(member);
            members.put(member, member);
            // membersLayout.addComponent(new Label(member));
          } else {
            String firstName = user.getFirstName();
            String lastName = user.getLastName();

            String email = user.getEmailAddress();

            String userString =
                &quot;&lt;a href=\&quot;mailto:&quot; + email + &quot;\&quot; style=\&quot;color: #0068AA; text-decoration: none\&quot;&gt;&quot;
                    + lastName + &quot;, &quot; + firstName + &quot;&lt;/a&gt;&quot;;
            if (user.getLastName().length() &gt; 0) {
              members.put(user.getLastName(), userString);
            }

            else {
              members.put(user.getFirstName(), userString);
            }

            // memberString.append(&quot;&lt;a href=\&quot;mailto:&quot;);
            // memberString.append(email);
            // memberString.append(&quot;\&quot; style=\&quot;color: #0068AA; text-decoration: none\&quot;&gt;&quot;);
            // memberString.append(fullname);
            // memberString.append(&quot;&lt;/a&gt;&quot;);
          }
        }
        synchronized (UI.getCurrent()) {
          processedMember();
        }
      }
    }
  }

  /**
   * 
   * @return
   */
  private Component getMembersComponent() {
    membersLayout = new HorizontalLayout();
    // membersLayout.setIcon(FontAwesome.USERS);
    // membersLayout.setCaption(&quot;Members&quot;);
    membersLayout.setWidth(&quot;100%&quot;);


    // final Button loadMembers = new Button(&quot;[+]&quot;);
    // membersLayout.addComponent(loadMembers);
    // loadMembers.setStyleName(ValoTheme.BUTTON_LINK);
    // loadMembers.addClickListener(new ClickListener() {

    // @Override
    // public void buttonClick(ClickEvent event) {
    ProgressBar progress = new ProgressBar();
    progress.setIndeterminate(true);
    Label info = new Label(
        &quot;Searching for members. Can take several seconds on big projects. Please be patient.&quot;);
    info.setStyleName(ValoTheme.LABEL_SUCCESS);
    // membersLayout.addComponent(info);
    membersLayout.addComponent(progress);
    MemberWorker worker = new MemberWorker();
    worker.start();
    UI.getCurrent().setPollInterval(500);
    // loadMembers.setEnabled(false);

    return membersLayout;
  }


  public void processedMember() {
    String memberString = &quot;&quot;;
    Label label;

    if (members.size() &lt; 1) {
      label = new Label(&quot;No Members found.&quot;);
    } else {
      for (Entry&lt;String, String&gt; entry : members.entrySet()) {
        String firstLetter = String.valueOf(entry.getKey().charAt(0));

        if (!memberLetters.containsKey(firstLetter)) {
          memberString +=
              String.format(&quot;&lt;font size='16'&gt;&lt;b&gt;%s&lt;/b&gt;&lt;/font&gt;&lt;br&gt;&quot;, firstLetter.toUpperCase());
          memberLetters.put(firstLetter, &quot;&quot;);
        }

        memberString += String.format(&quot;%s&lt;br&gt;&quot;, entry.getValue());
      }
      label = new Label(memberString, ContentMode.HTML);
    }

    // if (memberString == null || memberString.length() == 0) {
    // label = new Label(&quot;no members found.&quot;);
    // } else {
    // label = new Label(memberString.toString(), ContentMode.HTML);
    // }

    membersLayout.removeAllComponents();
    membersLayout.addComponent(label);
    membersLayout.setSpacing(true);
    membersLayout.setMargin(new MarginInfo(false, false, true, true));


    UI.getCurrent().setPollInterval(-1);
    // loadMembers.setVisible(false);
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L691">691</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L638">638</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            dataset_container.getContainerProperty(new_file, &quot;isDirectory&quot;).setValue(false);
            if (parent != null) {
                dataset_container.setParent(new_file, parent);
            }
        }
    }


    private class TableCheckBoxValueChangeListener implements ValueChangeListener {

        /**
         *
         */
        private static final long serialVersionUID = -7177199525909283879L;
        private Object itemId;
        private String itemFolderName;

        public TableCheckBoxValueChangeListener(final Object itemId, String itemFolderName) {
            this.itemFolderName = itemFolderName;
            this.itemId = itemId;
        }

        @Override
        public void valueChange(ValueChangeEvent event) {

            PortletSession portletSession = ((ProjectBrowserPortlet) UI.getCurrent()).getPortletSession();

            Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries =
                (Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt;) portletSession
                    .getAttribute(&quot;qbic_download&quot;, PortletSession.APPLICATION_SCOPE);

            boolean itemSelected = (Boolean) event.getProperty().getValue();
            /*
             * String fileName = &quot;&quot;; Object parentId = table.getParent(itemId); //In order to prevent
             * infinity loop int folderDepth = 0; while(parentId != null &amp;&amp; folderDepth &lt; 100){ fileName =
             * Paths.get((String) table.getItem(parentId).getItemProperty(&quot;File Name&quot;).getValue(),
             * fileName).toString(); parentId = table.getParent(parentId); folderDepth++; }
             */

            valueChange(itemId, itemSelected, entries, itemFolderName);
            portletSession.setAttribute(&quot;qbic_download&quot;, entries, PortletSession.APPLICATION_SCOPE);

            if (entries == null || entries.isEmpty()) {
                download.setResource(new ExternalResource(&quot;javascript:&quot;));
                download.setEnabled(false);
            } else {
                String resourceUrl =
                    (String) portletSession.getAttribute(&quot;resURL&quot;, PortletSession.APPLICATION_SCOPE);
                download.setResource(new ExternalResource(resourceUrl));
                download.setEnabled(true);
            }

        }

        /**
         * updates entries (puts and removes) for selected table item and all its children. Means Checkbox is updated. And in case download button is clicked
         * all checked items will be downloaded.
         *
         * @param itemId Container id
         * @param itemSelected checkbox value of the item
         * @param entries all checked items
         * @param fileName fileName of current item
         */
        private void valueChange(Object itemId, boolean itemSelected,
            Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries, String fileName) {

            ((CheckBox) table.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue())
                .setValue(itemSelected);
            fileName = Paths
                .get(fileName, (String) table.getItem(itemId).getItemProperty(&quot;File Name&quot;).getValue())
                .toString();

            // System.out.println(fileName);
            if (table.hasChildren(itemId)) {
                for (Object childId : table.getChildren(itemId)) {
                    valueChange(childId, itemSelected, entries, fileName);
                }
            } else if (itemSelected) {
                String datasetCode = (String) table.getItem(itemId).getItemProperty(&quot;CODE&quot;).getValue();

                Long datasetFileSize =
                    (Long) table.getItem(itemId).getItemProperty(&quot;file_size_bytes&quot;).getValue();

                entries.put(fileName,
                    new SimpleEntry&lt;String, Long&gt;(datasetCode, datasetFileSize));
            } else {
                entries.remove(fileName);
            }
        }
    }

    /**
     * The input should have the following form: type=openbis_type&amp;id=openbis_id e.g. type=sample&amp;id=/ABI_SYSBIO/QMARI117AV It is specifically designed to be
     * used in the case of datasetView. In other cases there is no guarantee that it will work correctly. returns a map with two entries: &quot;type&quot;: &quot;openbistype&quot;
     * &quot;id&quot; : &quot;openbisId&quot;
     */
    public static Map&lt;String, String&gt; getMap(String parameters) {
        if (parameters == null || parameters.equals(&quot;&quot;)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L986">986</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L907">907</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      dataset_container.getContainerProperty(new_file, &quot;isDirectory&quot;).setValue(false);

      if (parent != null) {
        dataset_container.setParent(new_file, parent);
      }
    }
  }


  private class TableCheckBoxValueChangeListener implements ValueChangeListener {

    /**
     *
     */
    private static final long serialVersionUID = -7177199525909283879L;
    private Object itemId;
    private String itemFolderName;

    public TableCheckBoxValueChangeListener(final Object itemId, String itemFolderName) {
      this.itemFolderName = itemFolderName;
      this.itemId = itemId;
    }

    @Override
    public void valueChange(ValueChangeEvent event) {

      PortletSession portletSession = ((ProjectBrowserPortlet) UI.getCurrent()).getPortletSession();
      Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries =
          (Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt;) portletSession.getAttribute(&quot;qbic_download&quot;,
              PortletSession.APPLICATION_SCOPE);

      boolean itemSelected = (Boolean) event.getProperty().getValue();
      /*
       * String fileName = &quot;&quot;; Object parentId = table.getParent(itemId); //In order to prevent
       * infinity loop int folderDepth = 0; while(parentId != null &amp;&amp; folderDepth &lt; 100){ fileName =
       * Paths.get((String) table.getItem(parentId).getItemProperty(&quot;File Name&quot;).getValue(),
       * fileName).toString(); parentId = table.getParent(parentId); folderDepth++; }
       */

      valueChange(itemId, itemSelected, entries, itemFolderName);
      portletSession.setAttribute(&quot;qbic_download&quot;, entries, PortletSession.APPLICATION_SCOPE);

      if (entries == null || entries.isEmpty()) {
        download.setResource(new ExternalResource(&quot;javascript:&quot;));
        download.setEnabled(false);
      } else {
        String resourceUrl =
            (String) portletSession.getAttribute(&quot;resURL&quot;, PortletSession.APPLICATION_SCOPE);
        download.setResource(new ExternalResource(resourceUrl));
        download.setEnabled(true);
      }

    }

    /**
     * updates entries (puts and removes) for selected table item and all its children. Means
     * Checkbox is updated. And in case download button is clicked all checked items will be
     * downloaded.
     *
     * @param itemId Container id
     * @param itemSelected checkbox value of the item
     * @param entries all checked items
     * @param fileName fileName of current item
     */
    private void valueChange(Object itemId, boolean itemSelected,
        Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries, String fileName) {

      ((CheckBox) datasetTable.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue())
          .setValue(itemSelected);
      fileName = Paths
          .get(fileName,
              (String) datasetTable.getItem(itemId).getItemProperty(&quot;File Name&quot;).getValue())
          .toString();

      // System.out.println(fileName);
      if (datasetTable.hasChildren(itemId)) {
        for (Object childId : datasetTable.getChildren(itemId)) {
          valueChange(childId, itemSelected, entries, fileName);
        }
      } else if (itemSelected) {
        String datasetCode =
            (String) datasetTable.getItem(itemId).getItemProperty(&quot;CODE&quot;).getValue();
        Long datasetFileSize =
            (Long) datasetTable.getItem(itemId).getItemProperty(&quot;file_size_bytes&quot;).getValue();
        entries.put(fileName, new SimpleEntry&lt;String, Long&gt;(datasetCode, datasetFileSize));
      } else {
        entries.remove(fileName);
      }
    }
  }

  /**
   * The input should have the following form: type=openbis_type&amp;id=openbis_id e.g.
   * type=sample&amp;id=/ABI_SYSBIO/QMARI117AV It is specifically designed to be used in the case of
   * datasetView. In other cases there is no guarantee that it will work correctly. returns a map
   * with two entries: &quot;type&quot;: &quot;openbistype&quot; &quot;id&quot; : &quot;openbisId&quot;
   */
  public static Map&lt;String, String&gt; getMap(String parameters) {
    if (parameters == null || parameters.equals(&quot;&quot;)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L678">678</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L973">973</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            dataset_container.getContainerProperty(new_file, &quot;Description&quot;).setValue(secName);
            // dataset_container.getContainerProperty(new_file, &quot;Sample Type&quot;).setValue(sampleType);
            dataset_container.getContainerProperty(new_file, &quot;File Name&quot;).setValue(d.getFileName());
            dataset_container.getContainerProperty(new_file, &quot;File Type&quot;).setValue(d.getFileType());
            dataset_container.getContainerProperty(new_file, &quot;Dataset Type&quot;)
                .setValue(prettyNameMapper.getPrettyName(d.getType()));
            dataset_container.getContainerProperty(new_file, &quot;Registration Date&quot;).setValue(ts);
            dataset_container.getContainerProperty(new_file, &quot;Validated&quot;).setValue(true);
            dataset_container.getContainerProperty(new_file, &quot;File Size&quot;)
                .setValue(PortalUtils.humanReadableByteCount(d.getFileSize(), true));
            dataset_container.getContainerProperty(new_file, &quot;dl_link&quot;).setValue(d.getDssPath());
            dataset_container.getContainerProperty(new_file, &quot;CODE&quot;).setValue(d.getCode());
            dataset_container.getContainerProperty(new_file, &quot;file_size_bytes&quot;).setValue(d.getFileSize());
            dataset_container.getContainerProperty(new_file, &quot;isDirectory&quot;).setValue(false);
            if (parent != null) {
                dataset_container.setParent(new_file, parent);
            }
        }
    }


    private class TableCheckBoxValueChangeListener implements ValueChangeListener {

        /**
         *
         */
        private static final long serialVersionUID = -7177199525909283879L;
        private Object itemId;
        private String itemFolderName;

        public TableCheckBoxValueChangeListener(final Object itemId, String itemFolderName) {
            this.itemFolderName = itemFolderName;
            this.itemId = itemId;
        }

        @Override
        public void valueChange(ValueChangeEvent event) {

            PortletSession portletSession = ((ProjectBrowserPortlet) UI.getCurrent()).getPortletSession();

            Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries =
                (Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt;) portletSession
                    .getAttribute(&quot;qbic_download&quot;, PortletSession.APPLICATION_SCOPE);

            boolean itemSelected = (Boolean) event.getProperty().getValue();
            /*
             * String fileName = &quot;&quot;; Object parentId = table.getParent(itemId); //In order to prevent
             * infinity loop int folderDepth = 0; while(parentId != null &amp;&amp; folderDepth &lt; 100){ fileName =
             * Paths.get((String) table.getItem(parentId).getItemProperty(&quot;File Name&quot;).getValue(),
             * fileName).toString(); parentId = table.getParent(parentId); folderDepth++; }
             */

            valueChange(itemId, itemSelected, entries, itemFolderName);
            portletSession.setAttribute(&quot;qbic_download&quot;, entries, PortletSession.APPLICATION_SCOPE);

            if (entries == null || entries.isEmpty()) {
                download.setResource(new ExternalResource(&quot;javascript:&quot;));
                download.setEnabled(false);
            } else {
                String resourceUrl =
                    (String) portletSession.getAttribute(&quot;resURL&quot;, PortletSession.APPLICATION_SCOPE);
                download.setResource(new ExternalResource(resourceUrl));
                download.setEnabled(true);
            }

        }

        /**
         * updates entries (puts and removes) for selected table item and all its children. Means Checkbox is updated. And in case download button is clicked
         * all checked items will be downloaded.
         *
         * @param itemId Container id
         * @param itemSelected checkbox value of the item
         * @param entries all checked items
         * @param fileName fileName of current item
         */
        private void valueChange(Object itemId, boolean itemSelected,
            Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries, String fileName) {

            ((CheckBox) table.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue())</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L898">898</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L629">629</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      dataset_container.getContainerProperty(new_file, &quot;File Name&quot;).setValue(d.getFileName());
      dataset_container.getContainerProperty(new_file, &quot;File Type&quot;).setValue(d.getFileType());
      dataset_container.getContainerProperty(new_file, &quot;Dataset Type&quot;).setValue(d.getType());
      dataset_container.getContainerProperty(new_file, &quot;Registration Date&quot;).setValue(ts);
      dataset_container.getContainerProperty(new_file, &quot;Validated&quot;).setValue(true);
      dataset_container.getContainerProperty(new_file, &quot;File Size&quot;)
          .setValue(PortalUtils.humanReadableByteCount(d.getFileSize(), true));
      dataset_container.getContainerProperty(new_file, &quot;dl_link&quot;).setValue(d.getDssPath());
      dataset_container.getContainerProperty(new_file, &quot;CODE&quot;).setValue(d.getCode());
      dataset_container.getContainerProperty(new_file, &quot;file_size_bytes&quot;).setValue(d.getFileSize());
      if (parent != null) {
        dataset_container.setParent(new_file, parent);
      }
    }
  }



  private class TableCheckBoxValueChangeListener implements ValueChangeListener {

    /**
     * 
     */
    private static final long serialVersionUID = -7177199525909283879L;
    private Object itemId;
    private String itemFolderName;

    public TableCheckBoxValueChangeListener(final Object itemId, String itemFolderName) {
      this.itemFolderName = itemFolderName;
      this.itemId = itemId;
    }

    @Override
    public void valueChange(ValueChangeEvent event) {

      PortletSession portletSession = ((ProjectBrowserPortlet) UI.getCurrent()).getPortletSession();
      Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries =
          (Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt;) portletSession.getAttribute(&quot;qbic_download&quot;,
              PortletSession.APPLICATION_SCOPE);

      boolean itemSelected = (Boolean) event.getProperty().getValue();
      /*
       * String fileName = &quot;&quot;; Object parentId = table.getParent(itemId); //In order to prevent
       * infinity loop int folderDepth = 0; while(parentId != null &amp;&amp; folderDepth &lt; 100){ fileName =
       * Paths.get((String) table.getItem(parentId).getItemProperty(&quot;File Name&quot;).getValue(),
       * fileName).toString(); parentId = table.getParent(parentId); folderDepth++; }
       */

      valueChange(itemId, itemSelected, entries, itemFolderName);
      portletSession.setAttribute(&quot;qbic_download&quot;, entries, PortletSession.APPLICATION_SCOPE);

      if (entries == null || entries.isEmpty()) {
        download.setResource(new ExternalResource(&quot;javascript:&quot;));
        download.setEnabled(false);
      } else {
        String resourceUrl =
            (String) portletSession.getAttribute(&quot;resURL&quot;, PortletSession.APPLICATION_SCOPE);
        download.setResource(new ExternalResource(resourceUrl));
        download.setEnabled(true);
      }

    }

    /**
     * updates entries (puts and removes) for selected table item and all its children. Means
     * Checkbox is updated. And in case download button is clicked all checked items will be
     * downloaded.
     * 
     * @param itemId Container id
     * @param itemSelected checkbox value of the item
     * @param entries all checked items
     * @param fileName fileName of current item
     */
    private void valueChange(Object itemId, boolean itemSelected,
        Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries, String fileName) {

      ((CheckBox) datasetTable.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue())</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L441">441</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L543">543</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  private void serveProject(ProjectBean bean, TarWriter writer, ResourceResponse response,
      OpenBisClient openbisClient) {
    String filename = bean.getCode() + &quot;.tar&quot;;

    response.setContentType(writer.getContentType());
    StringBuilder sb = new StringBuilder(&quot;attachement; filename=\&quot;&quot;);
    sb.append(filename);
    sb.append(&quot;\&quot;&quot;);
    response.setProperty(&quot;Content-Disposition&quot;, sb.toString());
    Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries = convertBeanToEntries(bean);

    long tarFileLength = writer.computeTarLength2(entries);
    // response.setContentLength((int) tarFileLength);
    // For some reason setContentLength does not work
    response.setProperty(&quot;Content-Length&quot;, String.valueOf(tarFileLength));
    try {
      writer.setOutputStream(response.getPortletOutputStream());
    } catch (IOException e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
    }

    Set&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; entrySet = entries.entrySet();
    Iterator&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; it = entrySet.iterator();
    while (it.hasNext()) {
      Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entry = it.next();
      String entryKey = entry.getKey().replaceFirst(entry.getValue().getKey() + &quot;/&quot;, &quot;&quot;);
      String[] splittedFilePath = entryKey.split(&quot;/&quot;);

      if ((splittedFilePath.length == 0) || (splittedFilePath == null)) {
        writer.writeEntry(bean.getCode() + &quot;/&quot; + entry.getKey(),
            openbisClient.getDatasetStream(entry.getValue().getKey()), entry.getValue().getValue());
      } else {
        writer.writeEntry(bean.getCode() + &quot;/&quot; + entry.getKey(), openbisClient.getDatasetStream(
            entry.getValue().getKey(), entryKey), entry.getValue().getValue());
      }
    }
    writer.closeStream();
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/model/SearchResultsExperimentBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/SearchResultsExperimentBean.html#L87">87</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/model/SearchResultsSampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/SearchResultsSampleBean.html#L88">88</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            ex.printStackTrace();
          }

          for (String k2 : xmlPropsMap.keySet()) {
            patternMatch = tmpPattern.matcher(xmlPropsMap.get(k2).trim());

            if (patternMatch.find()) {
              if (!&quot;&quot;.equals(strbuild.toString())) {
                strbuild.append(&quot;, &quot;);
              }
              strbuild.append(k2 + &quot;: &quot; + xmlPropsMap.get(k2));
            }
          }
        } else {
          patternMatch = tmpPattern.matcher(props.get(k));

          if (patternMatch.find()) {
            if (!&quot;&quot;.equals(strbuild.toString())) {
              strbuild.append(&quot;, &quot;);
            }

            strbuild.append(k + &quot;: &quot; + props.get(k));
          }
        }
      }
    }

    String result = strbuild.toString();

    return result;
  }

  private Map&lt;String, String&gt; parseXMLString(String input) throws Exception {

    Map&lt;String, String&gt; xmlProps = new HashMap&lt;String, String&gt;();
    Document xmlDoc = null;
    try {
      DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
      DocumentBuilder builder = factory.newDocumentBuilder();
      InputSource is = new InputSource(new StringReader(input));
      xmlDoc = builder.parse(is);

    } catch (Exception e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
    }

    if (xmlDoc != null) {
      NodeList nodes = xmlDoc.getElementsByTagName(&quot;qcategorical&quot;);

      for (int i = 0; i &lt; nodes.getLength(); ++i) {
        Element element = (Element) nodes.item(i);

        String factorName = element.getAttribute(&quot;label&quot;);
        String factorValue = element.getAttribute(&quot;value&quot;);
        // System.out.println(&quot;Name: &quot; + factorName + &quot; &quot; + factorValue);
        xmlProps.put(factorName, factorValue);
      }

    }

    return xmlProps;
  }

  private String extractSampleProperty(Experiment e, String propertyKey) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.html#L232">232</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.html#L326">326</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      PropertyType type = f.getType();

      String label = f.getLabel();
      if (f.hasUnit())
        label += &quot; in &quot; + f.getUnit();
      TextField tf = new TextField(label);
      tf.setData(type);// save property type for later, when it is written back
      fieldGroup.bind(tf, label);
      tf.setCaption(label);
      tf.setDescription(&quot;Q_PROPERTIES&quot;);
      tf.setValue((String) f.getValue());
      form2.addComponent(tf);
    }

    for (String key : properties.keySet()) {
      if (controlledVocabularies.keySet().contains(key)) {
        ComboBox select = new ComboBox(controlledVocabularies.get(key).getLabel());
        fieldGroup.bind(select, key);

        // Add items with given item IDs
        select.addItems(controlledVocabularies.get(key).getVocabularyValues());

        select.setDescription(controlledVocabularies.get(key).getCode());
        select.setValue(properties.get(key).getValue());

        form2.addComponent(select);

      } else {
        TextField tf = new TextField(key);
        fieldGroup.bind(tf, key);
        tf.setCaption(properties.get(key).getLabel());
        tf.setDescription(properties.get(key).getCode());
        tf.setValue((String) properties.get(key).getValue());
        form2.addComponent(tf);
      }
    }
    this.fieldGroup = fieldGroup;
    this.form = form2;
  }
}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/WorkflowComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/WorkflowComponent.html#L366">366</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/WorkflowView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/WorkflowView.html#L325">325</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      this.submission.addComponent(diffComp);
    } else {
      StandardWorkflowComponent standardComponent = new StandardWorkflowComponent(controller);
      standardComponent.update(workFlow, projectDatasets);
      standardComponent.addResetListener(new ResetListener(standardComponent));
      standardComponent.addSubmissionListener(new StandardSubmissionListener(standardComponent));
      this.submission.addComponent(standardComponent);
    }
  }

  private void addComponentListeners() {

    availableWorkflows.setDetailsGenerator(new DetailsGenerator() {
      private static final long serialVersionUID = 6123522348935657638L;

      @Override
      public Component getDetails(RowReference rowReference) {
        Workflow w = (Workflow) rowReference.getItemId();

        Label description = new Label(w.getDescription(), ContentMode.HTML);
        description.setCaption(&quot;Description&quot;);

        VerticalLayout main = new VerticalLayout(description);
        main.setMargin(true);
        return main;
      }
    });

    availableWorkflows.addItemClickListener(new ItemClickListener() {
      private static final long serialVersionUID = 3786125825391677177L;

      @Override
      public void itemClick(ItemClickEvent event) {
        // TODO get path of datasetBean and set it as input ?!
        Workflow selectedWorkflow = (Workflow) event.getItemId();
        if (selectedWorkflow != null) {
          updateParameterView(selectedWorkflow, datasetBeans);
          submission.setVisible(true);

          // detailed Description should be visible
          availableWorkflows.setDetailsVisible(selectedWorkflow,
              !availableWorkflows.isDetailsVisible(selectedWorkflow));

        } else {
          LOG.warn(&quot;selected Workflow is null?&quot;);
          submission.setVisible(false);
        }

      }
    });
    availableWorkflows.setEditorEnabled(false);
  }

  private class ResetListener implements ClickListener {
    private static final long serialVersionUID = 6800369140265363672L;
    private StandardWorkflowComponent swc;

    public ResetListener(StandardWorkflowComponent standardWorkflowComponent) {
      swc = standardWorkflowComponent;
    }

    @Override
    public void buttonClick(ClickEvent event) {
      swc.resetParameters();
    }
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L452">452</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L503">503</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    long tarFileLength = writer.computeTarLength2(entries);
    // response.setContentLength((int) tarFileLength);
    // For some reason setContentLength does not work
    response.setProperty(&quot;Content-Length&quot;, String.valueOf(tarFileLength));
    try {
      writer.setOutputStream(response.getPortletOutputStream());
    } catch (IOException e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
    }

    Set&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; entrySet = entries.entrySet();
    Iterator&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; it = entrySet.iterator();
    while (it.hasNext()) {
      Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entry = it.next();
      String entryKey = entry.getKey().replaceFirst(entry.getValue().getKey() + &quot;/&quot;, &quot;&quot;);
      String[] splittedFilePath = entryKey.split(&quot;/&quot;);

      if ((splittedFilePath.length == 0) || (splittedFilePath == null)) {
        writer.writeEntry(bean.getCode() + &quot;/&quot; + entry.getKey(),
            openbisClient.getDatasetStream(entry.getValue().getKey()), entry.getValue().getValue());
      } else {
        writer.writeEntry(bean.getCode() + &quot;/&quot; + entry.getKey(), openbisClient.getDatasetStream(
            entry.getValue().getKey(), entryKey), entry.getValue().getValue());
      }
    }
    writer.closeStream();
  }

  /**
   * 
   * Note: the provided stream will be closed.
   * 
   * @param bean bean containing datasets.
   * @param writer writes
   * @param response writer writes to its outputstream
   * @param openbisClient
   */
  private void serveExperiment(ExperimentBean bean, TarWriter writer, ResourceResponse response,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L503">503</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L554">554</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    long tarFileLength = writer.computeTarLength2(entries);
    // response.setContentLength((int) tarFileLength);
    // For some reason setContentLength does not work
    response.setProperty(&quot;Content-Length&quot;, String.valueOf(tarFileLength));
    try {
      writer.setOutputStream(response.getPortletOutputStream());
    } catch (IOException e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
    }

    Set&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; entrySet = entries.entrySet();
    Iterator&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; it = entrySet.iterator();
    while (it.hasNext()) {
      Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entry = it.next();
      String entryKey = entry.getKey().replaceFirst(entry.getValue().getKey() + &quot;/&quot;, &quot;&quot;);
      String[] splittedFilePath = entryKey.split(&quot;/&quot;);

      if ((splittedFilePath.length == 0) || (splittedFilePath == null)) {
        writer.writeEntry(bean.getCode() + &quot;/&quot; + entry.getKey(),
            openbisClient.getDatasetStream(entry.getValue().getKey()), entry.getValue().getValue());
      } else {
        writer.writeEntry(bean.getCode() + &quot;/&quot; + entry.getKey(), openbisClient.getDatasetStream(
            entry.getValue().getKey(), entryKey), entry.getValue().getValue());
      }
    }
    writer.closeStream();
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/WorkflowComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/WorkflowComponent.html#L251">251</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/WorkflowView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/WorkflowView.html#L264">264</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>              &quot;info&quot;);
    }

    availableWorkflows.setContainerDataSource(filtergpcontainer(suitableWorkflows));
    // availableWorkflows.setColumnOrder(&quot;name&quot;, &quot;version&quot;, &quot;fileTypes&quot;);
    availableWorkflows.setColumnOrder(&quot;name&quot;, &quot;version&quot;);

    workflows.setVisible(true);
  }

  void showNotification(String message) {
    Notification notif = new Notification(message, Type.TRAY_NOTIFICATION);
    // Customize it
    notif.setDelayMsec(60000);
    notif.setPosition(Position.MIDDLE_CENTER);
    // Show it in the page
    notif.show(Page.getCurrent());

  }

  /**
   * filter grid columns
   * 
   * @param suitableWorkflows
   * @return
   */
  GeneratedPropertyContainer filtergpcontainer(BeanItemContainer&lt;Workflow&gt; suitableWorkflows) {
    // ONLY SHOW SPECIFIC COLUMNS IN GRID
    GeneratedPropertyContainer gpcontainer = new GeneratedPropertyContainer(suitableWorkflows);

    gpcontainer.removeContainerProperty(&quot;ID&quot;);
    gpcontainer.removeContainerProperty(&quot;fileTypes&quot;);
    gpcontainer.removeContainerProperty(&quot;data&quot;);
    gpcontainer.removeContainerProperty(&quot;datasetType&quot;);
    gpcontainer.removeContainerProperty(&quot;nodes&quot;);
    gpcontainer.removeContainerProperty(&quot;experimentType&quot;);
    gpcontainer.removeContainerProperty(&quot;parameterToNodesMapping&quot;);
    gpcontainer.removeContainerProperty(&quot;parameters&quot;);
    gpcontainer.removeContainerProperty(&quot;sampleType&quot;);
    gpcontainer.removeContainerProperty(&quot;description&quot;);
    return gpcontainer;
  }

  private void updateParameterView(Workflow workFlow, BeanItemContainer&lt;DatasetBean&gt; projectDatasets) {
    this.submission.setCaption(SUBMISSION_CAPTION + &quot;: &quot; + workFlow.getName());
    this.submission.removeAllComponents();

    if (workFlow.getName().equals(&quot;MaxQuant&quot;)) {
      BeanItemContainer&lt;RawFilesBean&gt; rawFilesBeans =
          new BeanItemContainer&lt;RawFilesBean&gt;(RawFilesBean.class);
      BeanItemContainer&lt;FastaBean&gt; selectedfastas =
          new BeanItemContainer&lt;FastaBean&gt;(FastaBean.class);
      BeanItemContainer&lt;FastaBean&gt; fastas = new BeanItemContainer&lt;FastaBean&gt;(FastaBean.class);
      FastaDB db = new FastaDB();
      fastas.addAll(db.getAll());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L691">691</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L907">907</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            dataset_container.getContainerProperty(new_file, &quot;isDirectory&quot;).setValue(false);
            if (parent != null) {
                dataset_container.setParent(new_file, parent);
            }
        }
    }


    private class TableCheckBoxValueChangeListener implements ValueChangeListener {

        /**
         *
         */
        private static final long serialVersionUID = -7177199525909283879L;
        private Object itemId;
        private String itemFolderName;

        public TableCheckBoxValueChangeListener(final Object itemId, String itemFolderName) {
            this.itemFolderName = itemFolderName;
            this.itemId = itemId;
        }

        @Override
        public void valueChange(ValueChangeEvent event) {

            PortletSession portletSession = ((ProjectBrowserPortlet) UI.getCurrent()).getPortletSession();

            Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries =
                (Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt;) portletSession
                    .getAttribute(&quot;qbic_download&quot;, PortletSession.APPLICATION_SCOPE);

            boolean itemSelected = (Boolean) event.getProperty().getValue();
            /*
             * String fileName = &quot;&quot;; Object parentId = table.getParent(itemId); //In order to prevent
             * infinity loop int folderDepth = 0; while(parentId != null &amp;&amp; folderDepth &lt; 100){ fileName =
             * Paths.get((String) table.getItem(parentId).getItemProperty(&quot;File Name&quot;).getValue(),
             * fileName).toString(); parentId = table.getParent(parentId); folderDepth++; }
             */

            valueChange(itemId, itemSelected, entries, itemFolderName);
            portletSession.setAttribute(&quot;qbic_download&quot;, entries, PortletSession.APPLICATION_SCOPE);

            if (entries == null || entries.isEmpty()) {
                download.setResource(new ExternalResource(&quot;javascript:&quot;));
                download.setEnabled(false);
            } else {
                String resourceUrl =
                    (String) portletSession.getAttribute(&quot;resURL&quot;, PortletSession.APPLICATION_SCOPE);
                download.setResource(new ExternalResource(resourceUrl));
                download.setEnabled(true);
            }

        }

        /**
         * updates entries (puts and removes) for selected table item and all its children. Means Checkbox is updated. And in case download button is clicked
         * all checked items will be downloaded.
         *
         * @param itemId Container id
         * @param itemSelected checkbox value of the item
         * @param entries all checked items
         * @param fileName fileName of current item
         */
        private void valueChange(Object itemId, boolean itemSelected,
            Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries, String fileName) {

            ((CheckBox) table.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue())</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L986">986</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L638">638</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      dataset_container.getContainerProperty(new_file, &quot;isDirectory&quot;).setValue(false);

      if (parent != null) {
        dataset_container.setParent(new_file, parent);
      }
    }
  }


  private class TableCheckBoxValueChangeListener implements ValueChangeListener {

    /**
     *
     */
    private static final long serialVersionUID = -7177199525909283879L;
    private Object itemId;
    private String itemFolderName;

    public TableCheckBoxValueChangeListener(final Object itemId, String itemFolderName) {
      this.itemFolderName = itemFolderName;
      this.itemId = itemId;
    }

    @Override
    public void valueChange(ValueChangeEvent event) {

      PortletSession portletSession = ((ProjectBrowserPortlet) UI.getCurrent()).getPortletSession();
      Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries =
          (Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt;) portletSession.getAttribute(&quot;qbic_download&quot;,
              PortletSession.APPLICATION_SCOPE);

      boolean itemSelected = (Boolean) event.getProperty().getValue();
      /*
       * String fileName = &quot;&quot;; Object parentId = table.getParent(itemId); //In order to prevent
       * infinity loop int folderDepth = 0; while(parentId != null &amp;&amp; folderDepth &lt; 100){ fileName =
       * Paths.get((String) table.getItem(parentId).getItemProperty(&quot;File Name&quot;).getValue(),
       * fileName).toString(); parentId = table.getParent(parentId); folderDepth++; }
       */

      valueChange(itemId, itemSelected, entries, itemFolderName);
      portletSession.setAttribute(&quot;qbic_download&quot;, entries, PortletSession.APPLICATION_SCOPE);

      if (entries == null || entries.isEmpty()) {
        download.setResource(new ExternalResource(&quot;javascript:&quot;));
        download.setEnabled(false);
      } else {
        String resourceUrl =
            (String) portletSession.getAttribute(&quot;resURL&quot;, PortletSession.APPLICATION_SCOPE);
        download.setResource(new ExternalResource(resourceUrl));
        download.setEnabled(true);
      }

    }

    /**
     * updates entries (puts and removes) for selected table item and all its children. Means
     * Checkbox is updated. And in case download button is clicked all checked items will be
     * downloaded.
     *
     * @param itemId Container id
     * @param itemSelected checkbox value of the item
     * @param entries all checked items
     * @param fileName fileName of current item
     */
    private void valueChange(Object itemId, boolean itemSelected,
        Map&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entries, String fileName) {

      ((CheckBox) datasetTable.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue())</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/model/BiologicalEntitySampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/BiologicalEntitySampleBean.html#L110">110</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/model/BiologicalSampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/BiologicalSampleBean.html#L113">113</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    return id.compareTo(((BiologicalEntitySampleBean) o).getId());
  }

  @Override
  public boolean equals(Object o) {
    if (o instanceof SampleBean) {
      SampleBean b = (SampleBean) o;
      return id.equals(b.getId());
    } else
      return false;
  }

  @Override
  public int hashCode() {
    return id.hashCode();
  }

  public String getSecondaryName() {
    return secondaryName;
  }

  public void setSecondaryName(String secondaryName) {
    this.secondaryName = secondaryName;
  }

  public String getAdditionalInfo() {
    return additionalInfo;
  }

  public void setAdditionalInfo(String additionalInfo) {
    this.additionalInfo = additionalInfo;
  }

  public String getExternalDB() {
    return externalDB;
  }

  public void setExternalDB(String externalDB) {
    this.externalDB = externalDB;
  }


  public String getProperties() {
    return properties;
  }

  public void setProperties(Map&lt;String, String&gt; properties, List&lt;Property&gt; complexProps) {
    try {
      this.properties = generateXMLPropertiesFormattedString(complexProps);
    } catch (JAXBException e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
    }
  }

  public String generateXMLPropertiesFormattedString(List&lt;Property&gt; properties)
      throws JAXBException {

    String xmlPropertiesString = &quot;&quot;;

    for (Property p : properties) {
      xmlPropertiesString += p.getLabel() + &quot;: &quot; + p.getValue();
      if (p.hasUnit()) {
        xmlPropertiesString += &quot; &quot; + p.getUnit();
      }
      xmlPropertiesString += &quot; &quot;;
    }
    return xmlPropertiesString;
  }

//  public String generateXMLPropertiesFormattedString(Map&lt;String, String&gt; properties)
//      throws JAXBException {
//
//    String xmlPropertiesString = &quot;&quot;;
//    Iterator&lt;Entry&lt;String, String&gt;&gt; it = properties.entrySet().iterator();
//    while (it.hasNext()) {
//      Entry pairs = (Entry) it.next();
//      if (pairs.getKey().equals(&quot;Q_PROPERTIES&quot;)) {
//        XMLParser xmlParser = new XMLParser();
//        JAXBElement&lt;Qproperties&gt; xmlProperties =
//            xmlParser.parseXMLString(pairs.getValue().toString());
//        Map&lt;String, String&gt; xmlPropertiesMap = xmlParser.getMapOfProperties(xmlProperties);
//
//        Iterator itProperties = xmlPropertiesMap.entrySet().iterator();
//        while (itProperties.hasNext()) {
//          Entry pairsProperties = (Entry) itProperties.next();
//
//          xmlPropertiesString += pairsProperties.getKey() + &quot;: &quot; + pairsProperties.getValue() + &quot; &quot;;
//        }
//        break;
//      }
//    }
//    return xmlPropertiesString;
//  }

  public String getOrganism() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L1121">1121</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/ProjectView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/ProjectView.html#L606">606</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public PatientView getCurrent() {
    return this;
  }

  void updateContentGraph() {
    String projectID = currentBean.getId();
    List&lt;Sample&gt; samples = datahandler.getOpenBisClient()
        .getSamplesWithParentsAndChildrenOfProjectBySearchService(projectID);
    parseNewGraph(projectID, samples);
    Resource resource = getGraphResource(projectID, samples);

    if (resource != null) {
      graphSectionContent.removeAllComponents();
      Image graphImage = new Image(&quot;&quot;, resource);

      graphSectionContent.addComponent(graphImage);
      graphSectionContent.setComponentAlignment(graphImage, Alignment.MIDDLE_CENTER);

    } else {
      Label error = new Label(&quot;Project Graph can not be computed at that time for this project&quot;);
      error.setStyleName(ValoTheme.LABEL_FAILURE);
      graphSectionContent.removeAllComponents();
      graphSectionContent.addComponent(error);
      graphSectionContent.setComponentAlignment(error, Alignment.MIDDLE_CENTER);

      LOG.error(String.format(&quot;%s: %s&quot;, error.getValue(), currentBean.getId()));
    }
  }

  private void parseNewGraph(String projectID, List&lt;Sample&gt; samples) {
    List&lt;DataSet&gt; datasets =
        datahandler.getOpenBisClient().getDataSetsOfProjectByIdentifier(projectID);
    Set&lt;String&gt; factorLabels = datahandler.getFactorLabels();
    
    Map&lt;Pair&lt;String, String&gt;, Property&gt; factorsForLabelsAndSamples =
        datahandler.getFactorsForLabelsAndSamples();
    newGraphContent.loadProjectGraph(projectID, samples, datasets, factorLabels,
        factorsForLabelsAndSamples);
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/model/BiologicalSampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/BiologicalSampleBean.html#L69">69</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/model/TestSampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/TestSampleBean.html#L66">66</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public BiologicalSampleBean() {

  }



  public String getId() {
    return id;
  }



  public void setId(String id) {
    this.id = id;
  }



  public String getCode() {
    return code;
  }



  public void setCode(String code) {
    this.code = code;
  }



  public String getType() {
    return type;
  }



  public void setType(String type) {
    this.type = type;
  }



  @Override
  public int compareTo(Object o) {
    return id.compareTo(((SampleBean) o).getId());
  }

  @Override
  public boolean equals(Object o) {
    if (o instanceof SampleBean) {
      SampleBean b = (SampleBean) o;
      return id.equals(b.getId());
    } else
      return false;
  }

  @Override
  public int hashCode() {
    return id.hashCode();
  }

  public String getSecondaryName() {
    return secondaryName;
  }

  public void setSecondaryName(String secondaryName) {
    this.secondaryName = secondaryName;
  }

  public String getAdditionalInfo() {
    return additionalInfo;
  }

  public void setAdditionalInfo(String additionalInfo) {
    this.additionalInfo = additionalInfo;
  }

  public String getExternalDB() {
    return externalDB;
  }

  public void setExternalDB(String externalDB) {
    this.externalDB = externalDB;
  }


  public String getProperties() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L865">865</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L602">602</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      dataset_container.getContainerProperty(new_ds, &quot;File Name&quot;).setValue(d.getName());
      dataset_container.getContainerProperty(new_ds, &quot;File Type&quot;).setValue(&quot;Folder&quot;);
      dataset_container.getContainerProperty(new_ds, &quot;Dataset Type&quot;).setValue(d.getType());
      dataset_container.getContainerProperty(new_ds, &quot;Registration Date&quot;).setValue(ts);
      dataset_container.getContainerProperty(new_ds, &quot;Validated&quot;).setValue(true);
      dataset_container.getContainerProperty(new_ds, &quot;dl_link&quot;).setValue(d.getDssPath());
      dataset_container.getContainerProperty(new_ds, &quot;CODE&quot;).setValue(d.getCode());
      dataset_container.getContainerProperty(new_ds, &quot;file_size_bytes&quot;).setValue(d.getFileSize());

      if (parent != null) {
        dataset_container.setParent(new_ds, parent);
      }

      for (DatasetBean file : subList) {
        registerDatasetInTable(file, dataset_container, project, sample, ts, new_ds);
      }

    } else {
      // System.out.println(&quot;Now it should be a file: &quot; + filelist[0].getPathInDataSet());

      Object new_file = dataset_container.addItem();
      dataset_container.setChildrenAllowed(new_file, false);

      dataset_container.getContainerProperty(new_file, &quot;Select&quot;).setValue(new CheckBox());
      dataset_container.getContainerProperty(new_file, &quot;Project&quot;).setValue(project);
      dataset_container.getContainerProperty(new_file, &quot;Sample&quot;).setValue(sample);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L645">645</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L937">937</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            dataset_container.getContainerProperty(new_ds, &quot;Description&quot;).setValue(secName);
            // dataset_container.getContainerProperty(new_ds, &quot;Sample Type&quot;).setValue(
            // d.getSample().getType());
            dataset_container.getContainerProperty(new_ds, &quot;File Name&quot;).setValue(d.getName());
            dataset_container.getContainerProperty(new_ds, &quot;File Type&quot;).setValue(&quot;Folder&quot;);
            dataset_container.getContainerProperty(new_ds, &quot;Dataset Type&quot;)
                .setValue(prettyNameMapper.getPrettyName(d.getType()) + &quot; Folder&quot;);
            dataset_container.getContainerProperty(new_ds, &quot;Registration Date&quot;).setValue(ts);
            dataset_container.getContainerProperty(new_ds, &quot;Validated&quot;).setValue(true);
            dataset_container.getContainerProperty(new_ds, &quot;dl_link&quot;).setValue(d.getDssPath());
            dataset_container.getContainerProperty(new_ds, &quot;CODE&quot;).setValue(d.getCode());
            dataset_container.getContainerProperty(new_ds, &quot;file_size_bytes&quot;).setValue(d.getFileSize());
            dataset_container.getContainerProperty(new_ds, &quot;isDirectory&quot;).setValue(true);

            if (parent != null) {
                dataset_container.setParent(new_ds, parent);
            }

            // LOG.debug(d+&quot; has files/folders:&quot;);
            for (DatasetBean file : subList) {
                // LOG.debug(file.getFileName());
                registerDatasetInTable(file, dataset_container, project, sample, ts, new_ds, secName);
            }

        } else {
            // LOG.debug(&quot;(no more subfolders)&quot;);
            // sut.println(&quot;Now it should be a file: &quot; + filelist[0].getPathInDataSet());

            Object new_file = dataset_container.addItem();
            dataset_container.setChildrenAllowed(new_file, false);
            dataset_container.getContainerProperty(new_file, &quot;Select&quot;).setValue(new CheckBox());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L126">126</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L152">152</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    public void updateUI(String type, String id) {

        if (id == null) {
            return;
        }
        try {
            HierarchicalContainer datasetContainer = new HierarchicalContainer();
            datasetContainer.addContainerProperty(&quot;Select&quot;, CheckBox.class, null);
            datasetContainer.addContainerProperty(&quot;Project&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;Sample&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;Description&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;File Name&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;File Type&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;Dataset Type&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;Registration Date&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;Validated&quot;, Boolean.class, null);
            datasetContainer.addContainerProperty(&quot;File Size&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;file_size_bytes&quot;, Long.class, null);
            datasetContainer.addContainerProperty(&quot;dl_link&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;isDirectory&quot;, Boolean.class, null);
            datasetContainer.addContainerProperty(&quot;CODE&quot;, String.class, null);

            List&lt;ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet&gt; retrievedDatasets = null;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L872">872</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L796">796</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }


  private void setCheckedBox(Object itemId, String parentFolder) {
    CheckBox itemCheckBox =
        (CheckBox) this.datasetTable.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue();
    itemCheckBox.addValueChangeListener(new TableCheckBoxValueChangeListener(itemId, parentFolder));

    if (datasetTable.hasChildren(itemId)) {
      for (Object childId : datasetTable.getChildren(itemId)) {
        String newParentFolder = Paths
            .get(parentFolder,
                (String) this.datasetTable.getItem(itemId).getItemProperty(&quot;File Name&quot;).getValue())
            .toString();
        setCheckedBox(childId, newParentFolder);
      }
    }

  }

  private FilterTreeTable buildFilterTable() {
    FilterTreeTable filterTable = new FilterTreeTable();
    filterTable.setSizeFull();

    filterTable.setFilterDecorator(new DatasetViewFilterDecorator());
    filterTable.setFilterGenerator(new DatasetViewFilterGenerator());

    filterTable.setFilterBarVisible(true);

    filterTable.setSelectable(true);
    filterTable.setImmediate(true);
    filterTable.setMultiSelect(true);

    // filterTable.setRowHeaderMode(RowHeaderMode.INDEX);

    filterTable.setColumnCollapsingAllowed(true);

    filterTable.setColumnReorderingAllowed(true);

    if (this.datasets != null) {
      filterTable.setContainerDataSource(this.datasets);
    }

    return filterTable;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/PatientStatusComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/PatientStatusComponent.html#L99">99</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L777">777</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public void updateUI(final ProjectBean currentBean) {
    BeanItemContainer&lt;ExperimentStatusBean&gt; experimentstatusBeans =
        datahandler.computeIvacPatientStatus(currentBean);

    int finishedExperiments = 0;
    status.removeAllComponents();
    status.setWidth(100.0f, Unit.PERCENTAGE);


    // Generate button caption column
    final GeneratedPropertyContainer gpc = new GeneratedPropertyContainer(experimentstatusBeans);
    gpc.addGeneratedProperty(&quot;started&quot;, new PropertyValueGenerator&lt;String&gt;() {

      @Override
      public Class&lt;String&gt; getType() {
        return String.class;
      }

      @Override
      public String getValue(Item item, Object itemId, Object propertyId) {
        String status = null;

        if ((double) item.getItemProperty(&quot;status&quot;).getValue() &gt; 0.0) {
          status =
              &quot;&lt;span class=\&quot;v-icon\&quot; style=\&quot;font-family: &quot; + FontAwesome.CHECK.getFontFamily()
                  + &quot;;color:&quot; + &quot;#2dd085&quot; + &quot;\&quot;&gt;&amp;#x&quot;
                  + Integer.toHexString(FontAwesome.CHECK.getCodepoint()) + &quot;;&lt;/span&gt;&quot;;
        } else {
          status =
              &quot;&lt;span class=\&quot;v-icon\&quot; style=\&quot;font-family: &quot; + FontAwesome.TIMES.getFontFamily()
                  + &quot;;color:&quot; + &quot;#f54993&quot; + &quot;\&quot;&gt;&amp;#x&quot;
                  + Integer.toHexString(FontAwesome.TIMES.getCodepoint()) + &quot;;&lt;/span&gt;&quot;;
        }

        return status.toString();
      }
    });
    gpc.removeContainerProperty(&quot;identifier&quot;);

    experiments.setContainerDataSource(gpc);
    // experiments.setHeaderVisible(false);
    // experiments.setHeightMode(HeightMode.ROW);
    experiments.setHeightByRows(gpc.size());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/WorkflowComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/WorkflowComponent.html#L161">161</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/WorkflowView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/WorkflowView.html#L169">169</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    if (map == null)
      return;
    // TODO In background thread?
    type = map.get(&quot;type&quot;);
    id = map.get(&quot;id&quot;);

    switch (type) {
      case &quot;project&quot;:
        datasetBeans = controller.getcontainer(type, id);
        List&lt;String&gt; datasetTypesInProject = new ArrayList&lt;String&gt;();

        for (Iterator&lt;DatasetBean&gt; i = datasetBeans.getItemIds().iterator(); i.hasNext();) {
          DatasetBean dsBean = (DatasetBean) i.next();
          datasetTypesInProject.add(dsBean.getFileType());
        }
        updateWorkflowSelection(datasetTypesInProject);
        break;

      case &quot;experiment&quot;:
        break;

      case &quot;sample&quot;:
        break;

      case &quot;workflowExperimentType&quot;:
        String experiment = map.get(&quot;experiment&quot;);

        BeanItemContainer&lt;Workflow&gt; suitableWorkflows =
            controller.suitableWorkflowsByExperimentType(experiment);

        BeanItemContainer&lt;DatasetBean&gt; suitableDatasets =
            new BeanItemContainer&lt;DatasetBean&gt;(DatasetBean.class);

        List&lt;String&gt; workflowDatasetTypes = new ArrayList&lt;String&gt;();
        for (Iterator i = suitableWorkflows.getItemIds().iterator(); i.hasNext();) {
          Workflow workflowBean = (Workflow) i.next();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/controllers/DataHandler.java</td>
<td><a href="./xref/life/qbic/projectbrowser/controllers/DataHandler.html#L576">576</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/controllers/DataHandler.java</td>
<td><a href="./xref/life/qbic/projectbrowser/controllers/DataHandler.html#L815">815</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    List&lt;ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet&gt; projectData = this
        .getOpenBisClient().getDataSetsOfProjectByIdentifierWithSearchCriteria(projectIdentifier);

    Boolean containsData = false;
    Boolean containsResults = false;
    Boolean attachmentResult = false;
    // Boolean containsAttachments = false;

    for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet ds : projectData) {
      attachmentResult = false;
      if (ds.getDataSetTypeCode().equals(&quot;Q_PROJECT_DATA&quot;)) {
        attachmentResult = ds.getProperties().get(&quot;Q_ATTACHMENT_TYPE&quot;).equals(&quot;RESULT&quot;);
      }

      if (!(ds.getDataSetTypeCode().equals(&quot;Q_PROJECT_DATA&quot;))
          &amp;&amp; !(ds.getDataSetTypeCode().contains(&quot;RESULTS&quot;))) {
        containsData = true;
      } else if (ds.getDataSetTypeCode().contains(&quot;RESULTS&quot;) || attachmentResult) {
        containsResults = true;
      } // else if (ds.getDataSetTypeCode() == &quot;Q_PROJECT_DATA&quot;) {
        // containsAttachments = true;
      // }
    }

    newProjectBean.setContainsData(containsData);
    newProjectBean.setContainsResults(containsResults);

    newProjectBean.setExperiments(experimentBeans);
    newProjectBean.setMembers(new HashSet&lt;String&gt;());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.html#L246">246</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ChangeMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeMetadataComponent.html#L173">173</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.html#L340">340</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    for (String key : properties.keySet()) {
      if (controlledVocabularies.keySet().contains(key)) {
        ComboBox select = new ComboBox(controlledVocabularies.get(key).getLabel());
        fieldGroup.bind(select, key);

        // Add items with given item IDs
        select.addItems(controlledVocabularies.get(key).getVocabularyValues());

        select.setDescription(controlledVocabularies.get(key).getCode());
        select.setValue(properties.get(key).getValue());

        form2.addComponent(select);

      } else {
        TextField tf = new TextField(key);
        fieldGroup.bind(tf, key);
        tf.setCaption(properties.get(key).getLabel());
        tf.setDescription(properties.get(key).getCode());
        tf.setValue((String) properties.get(key).getValue());
        form2.addComponent(tf);
      }
    }
    this.fieldGroup = fieldGroup;
    this.form = form2;
  }
}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L545">545</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L403">403</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          MatchClause.createAttributeMatch(MatchClauseAttribute.PROJECT, projectBean.getCode()));
      sampleSc.addSubCriteria(SearchSubCriteria.createExperimentCriteria(projectSc));

      SearchCriteria experimentSc = new SearchCriteria();
      experimentSc.addMatchClause(MatchClause.createAttributeMatch(MatchClauseAttribute.TYPE,
          ExperimentType.Q_EXPERIMENTAL_DESIGN.name()));
      sampleSc.addSubCriteria(SearchSubCriteria.createExperimentCriteria(experimentSc));
      List&lt;Sample&gt; samples = datahandler.getOpenBisClient().getFacade().searchForSamples(sampleSc);
      for (Sample sample : samples) {
        if (sample.getProperties().get(&quot;Q_ADDITIONAL_INFO&quot;) != null) {
          available = true;
          String[] splitted = sample.getProperties().get(&quot;Q_ADDITIONAL_INFO&quot;).split(&quot;;&quot;);
          for (String s : splitted) {
            String[] splitted2 = s.split(&quot;:&quot;);
            patientInfo += String.format(&quot;&lt;p&gt;&lt;u&gt;%s&lt;/u&gt;: %s &lt;/p&gt; &quot;, splitted2[0], splitted2[1]);
          }
        }
      }



      if (available) {
        patientInformation.setValue(patientInfo);
      } else {
        patientInformation.setValue(&quot;No patient information provided.&quot;);
      }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L581">581</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L451">451</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        this.verticalLayout.addComponent(help);

    }

    private void setCheckedBox(Object itemId, String parentFolder) {
        CheckBox itemCheckBox =
            (CheckBox) this.table.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue();
        itemCheckBox.addValueChangeListener(new TableCheckBoxValueChangeListener(itemId, parentFolder));

        if (table.hasChildren(itemId)) {
            for (Object childId : table.getChildren(itemId)) {
                String newParentFolder = Paths
                    .get(parentFolder,
                        (String) this.table.getItem(itemId).getItemProperty(&quot;File Name&quot;).getValue())
                    .toString();
                setCheckedBox(childId, newParentFolder);
            }
        }

    }

    private FilterTreeTable buildFilterTable() {
        FilterTreeTable filterTable = new FilterTreeTable();
        filterTable.setSizeFull();

        filterTable.setFilterDecorator(new DatasetViewFilterDecorator());
        filterTable.setFilterGenerator(new DatasetViewFilterGenerator());

        filterTable.setFilterBarVisible(true);

        filterTable.setSelectable(true);
        filterTable.setImmediate(true);
        filterTable.setMultiSelect(true);

        // filterTable.setRowHeaderMode(RowHeaderMode.INDEX);

        filterTable.setColumnCollapsingAllowed(false);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/WorkflowComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/WorkflowComponent.html#L560">560</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/WorkflowView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/WorkflowView.html#L391">391</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    }
  }

  /**
   * listenes to clicks on submit button. Executes standard workflow.
   * 
   * @author wojnar
   * 
   */
  private class StandardSubmissionListener implements ClickListener {
    private static final long serialVersionUID = 243869502031843198L;
    private StandardWorkflowComponent swc;

    public StandardSubmissionListener(StandardWorkflowComponent standardWorkflowComponent) {
      swc = standardWorkflowComponent;
    }

    @Override
    public void buttonClick(ClickEvent event) {
      try {
        List&lt;DatasetBean&gt; selectedDatasets = swc.getSelectedDatasets();
        Workflow submittedWf = swc.getWorkflow();
        submit(submittedWf, new ArrayList&lt;DatasetBean&gt;(selectedDatasets));
      } catch (Exception e) {
        handleException(e);
      }
    }
  }
  /**
   * listenes to clicks on submit button. Executes maxquant workflow.
   * 
   * @author wojnar
   * 
   */
  private class MaxQuantSubmissionListener implements ClickListener {
    private static final long serialVersionUID = 1888557742642278371L;
    private MaxQuantComponent maxQuantComponent;

    public MaxQuantSubmissionListener(MaxQuantComponent mqc) {
      maxQuantComponent = mqc;
    }

    @Override
    public void buttonClick(ClickEvent event) {

      try {
        maxQuantComponent.updateGroups();
        maxQuantComponent.writeParametersToWorkflow();
        Workflow submittedWf = maxQuantComponent.getWorkflow();
        Collection&lt;DatasetBean&gt; selectedDatasets = maxQuantComponent.getSelectedDatasets();
        submit(submittedWf, new ArrayList&lt;DatasetBean&gt;(selectedDatasets));
      } catch (Exception e) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L211">211</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L388">388</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      LOG.debug(&quot;tar file length: &quot;+String.valueOf(tarFileLength));

      // Integer fileSize = (int) (long) tarFileLength;

      // For some reason setContentLength does not work
      response.setProperty(&quot;Content-Length&quot;, String.valueOf(tarFileLength));

      // Seems to work with Liferay 6.2, when using setProperty some tarred files are corrupt,
      // unexpected end of file
      // Didn't work with Liferay 6.2 either
      // However deactivating GzipFilter by setting
      // com.liferay.portal.servlet.filters.gzip.GZipFilter=false seems to fix it
      // Probably the Content Length can't be set in the header of this Filter
      // response.setContentLength(fileSize);


      try {
        writer.setOutputStream(response.getPortletOutputStream());

      } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
      }

      Set&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; entrySet = entries.entrySet();
      Iterator&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; it = entrySet.iterator();
      while (it.hasNext()) {
        Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entry = it.next();
        String entryKey = entry.getKey().replaceFirst(entry.getValue().getKey() + &quot;/&quot;, &quot;&quot;);
        String[] splittedFilePath = entryKey.split(&quot;/&quot;);

        if ((splittedFilePath.length == 0) || (splittedFilePath == null)) {
          // writer.writeEntry(entry.getValue().getKey() + &quot;/&quot; + entry.getKey(),
          writer.writeEntry(entry.getKey(), openbisClient.getDatasetStream(entry.getValue()</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L772">772</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L1069">1069</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                    (Long) table.getItem(itemId).getItemProperty(&quot;file_size_bytes&quot;).getValue();

                entries.put(fileName,
                    new SimpleEntry&lt;String, Long&gt;(datasetCode, datasetFileSize));
            } else {
                entries.remove(fileName);
            }
        }
    }

    /**
     * The input should have the following form: type=openbis_type&amp;id=openbis_id e.g. type=sample&amp;id=/ABI_SYSBIO/QMARI117AV It is specifically designed to be
     * used in the case of datasetView. In other cases there is no guarantee that it will work correctly. returns a map with two entries: &quot;type&quot;: &quot;openbistype&quot;
     * &quot;id&quot; : &quot;openbisId&quot;
     */
    public static Map&lt;String, String&gt; getMap(String parameters) {
        if (parameters == null || parameters.equals(&quot;&quot;)) {
            return null;
        }
        String[] params = parameters.split(&quot;&amp;&quot;);
        // TODO check for length == 2 needed ?
        // if (params == null || params.length != 2)
        if (params == null || params.length &gt; 3) {
            return null;
        }
        HashMap&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();
        for (String p : params) {
            String[] kv = p.split(&quot;=&quot;);
            if (kv.length != 2) {
                return null;
            }
            map.put(kv[0], kv[1]);
        }
        return map;
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L646">646</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L631">631</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    buttonLayout.setMargin(new MarginInfo(false, false, false, true));
    buttonLayout.setHeight(null);
    buttonLayout.setSpacing(true);

    this.download.setEnabled(false);
    buttonLayout.setSpacing(true);

    Button checkAll = new Button(&quot;Select all datasets&quot;);
    checkAll.addClickListener(new ClickListener() {

      @Override
      public void buttonClick(ClickEvent event) {
        for (Object itemId : datasetTable.getItemIds()) {
          ((CheckBox) datasetTable.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue())
              .setValue(true);
        }
      }
    });

    Button uncheckAll = new Button(&quot;Unselect all datasets&quot;);
    uncheckAll.addClickListener(new ClickListener() {

      @Override
      public void buttonClick(ClickEvent event) {
        for (Object itemId : datasetTable.getItemIds()) {
          ((CheckBox) datasetTable.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue())
              .setValue(false);
        }
      }
    });

    buttonLayout.addComponent(exportData);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/MicroarrayQCComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/MicroarrayQCComponent.html#L57">57</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/NGSMappingComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/NGSMappingComponent.html#L55">55</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public MicroarrayQCComponent(WorkflowViewController controller) {
    this.controller = controller;
    reset.setDescription(&quot;Reset Parameters to default values.&quot;);
    submit
        .setDescription(&quot;Execute Workflow. With given input files, database/reference files and parameters.&quot;);

    HorizontalLayout buttonContent = new HorizontalLayout();
    buttonContent.addComponent(reset);
    buttonContent.addComponent(submit);

    VerticalLayout submissionContent = new VerticalLayout();
    submissionContent.setSpacing(true);
    submissionContent.addComponent(inputFileComponent);
    submissionContent.addComponent(parameterComponent);
    submissionContent.addComponent(buttonContent);
    setCompositionRoot(submissionContent);
  }

  public List&lt;DatasetBean&gt; getSelectedDatasets() {
    return inputFileComponent.getSelectedDatasets();
  }

  public Workflow getWorkflow() {
    Workflow tmp = parameterComponent.getWorkflow();
    boolean success = inputFileComponent.updateWorkflow(tmp, controller);
    return success ? tmp : null;
  }

  public void update(Workflow workflow, BeanItemContainer&lt;DatasetBean&gt; input) {
    this.inputFileComponent.buildLayout(workflow.getData().getData(), input);
    this.parameterComponent.buildLayout(workflow);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L211">211</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L388">388</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L452">452</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L503">503</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L554">554</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      LOG.debug(&quot;tar file length: &quot;+String.valueOf(tarFileLength));

      // Integer fileSize = (int) (long) tarFileLength;

      // For some reason setContentLength does not work
      response.setProperty(&quot;Content-Length&quot;, String.valueOf(tarFileLength));

      // Seems to work with Liferay 6.2, when using setProperty some tarred files are corrupt,
      // unexpected end of file
      // Didn't work with Liferay 6.2 either
      // However deactivating GzipFilter by setting
      // com.liferay.portal.servlet.filters.gzip.GZipFilter=false seems to fix it
      // Probably the Content Length can't be set in the header of this Filter
      // response.setContentLength(fileSize);


      try {
        writer.setOutputStream(response.getPortletOutputStream());

      } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
      }

      Set&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; entrySet = entries.entrySet();
      Iterator&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; it = entrySet.iterator();
      while (it.hasNext()) {
        Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entry = it.next();
        String entryKey = entry.getKey().replaceFirst(entry.getValue().getKey() + &quot;/&quot;, &quot;&quot;);
        String[] splittedFilePath = entryKey.split(&quot;/&quot;);

        if ((splittedFilePath.length == 0) || (splittedFilePath == null)) {
          // writer.writeEntry(entry.getValue().getKey() + &quot;/&quot; + entry.getKey(),
          writer.writeEntry(entry.getKey(), openbisClient.getDatasetStream(entry.getValue()</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L990">990</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L719">719</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            (Long) datasetTable.getItem(itemId).getItemProperty(&quot;file_size_bytes&quot;).getValue();
        entries.put(fileName, new SimpleEntry&lt;String, Long&gt;(datasetCode, datasetFileSize));
      } else {
        entries.remove(fileName);
      }
    }
  }

  // TODO seems this isn't used. can we delete it?
  /**
   * The input should have the following form: type=openbis_type&amp;id=openbis_id e.g.
   * type=sample&amp;id=/ABI_SYSBIO/QMARI117AV It is specifically designed to be used in the case of
   * datasetView. In other cases there is no guarantee that it will work correctly. returns a map
   * with two entries: &quot;type&quot;: &quot;openbistype&quot; &quot;id&quot; : &quot;openbisId&quot;
   * 
   * @param parameters
   * @return
   */
  public static Map&lt;String, String&gt; getMap(String parameters) {
    if (parameters == null || parameters.equals(&quot;&quot;))
      return null;
    String[] params = parameters.split(&quot;&amp;&quot;);
    // TODO check for length == 2 needed ?
    // if (params == null || params.length != 2)
    if (params == null || params.length &gt; 3)
      return null;
    HashMap&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();
    for (String p : params) {
      String[] kv = p.split(&quot;=&quot;);
      if (kv.length != 2)
        return null;
      map.put(kv[0], kv[1]);
    }
    return map;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/controllers/DataHandler.java</td>
<td><a href="./xref/life/qbic/projectbrowser/controllers/DataHandler.html#L2338">2338</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/controllers/DataHandler.java</td>
<td><a href="./xref/life/qbic/projectbrowser/controllers/DataHandler.html#L2405">2405</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          if (sampleBean.getDnaSeq()) {
            String newSamplePreparationCode = newProjectCode + &quot;E&quot; + numberOfRegisteredExperiments;
            String newSamplePreparationID =
                &quot;/&quot; + space + &quot;/&quot; + newProjectCode + &quot;/&quot; + newSamplePreparationCode;
            newSamplePreparationIDs.add(newSamplePreparationID);
            numberOfRegisteredExperiments += 1;

            String newTestSampleCode =
                newProjectCode + Utils.createCountString(numberOfRegisteredSamples, 3) + &quot;B&quot;;
            String newTestSampleID = &quot;/&quot; + space + &quot;/&quot; + newTestSampleCode
                + BarcodeFunctions.checksum(newTestSampleCode);
            newTestSampleIDs.add(newTestSampleID);
            numberOfRegisteredSamples += 1;
            testTypes.add(&quot;DNA&quot;);

            String newNGSMeasurementCode = newProjectCode + &quot;E&quot; + numberOfRegisteredExperiments;
            String newNGSMeasurementID =
                &quot;/&quot; + space + &quot;/&quot; + newProjectCode + &quot;/&quot; + newNGSMeasurementCode;
            newNGSMeasurementIDs.add(newNGSMeasurementID);
            numberOfRegisteredExperiments += 1;

            String newNGSRunCode =
                newProjectCode + Utils.createCountString(numberOfRegisteredSamples, 3) + &quot;R&quot;;
            String newNGSRunID =
                &quot;/&quot; + space + &quot;/&quot; + newNGSRunCode + BarcodeFunctions.checksum(newNGSRunCode);
            newNGSRunIDs.add(newNGSRunID);
            numberOfRegisteredSamples += 1;

            additionalInfo.add(false);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/GraphGenerator.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/GraphGenerator.html#L199">199</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/GraphGenerator.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/GraphGenerator.html#L475">475</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          openBisClient.listPropertiesForType(openBisClient.getSampleTypeByString(&quot;Q_TEST_SAMPLE&quot;));


      for (Sample s : samps) {
        String species =
            (s.getProperties().containsKey(&quot;Q_NCBI_ORGANISM&quot;)) ? s.getProperties().get(
                &quot;Q_NCBI_ORGANISM&quot;) : &quot;&quot;;

        // old get species code
        /*
         * for (Map.Entry&lt;String, String&gt; entry : s.getProperties().entrySet()) { if
         * (entry.getKey().equals(&quot;Q_NCBI_ORGANISM&quot;)) { species = entry.getValue(); } }
         */

        // TODO get Labels of properties.... for organism
        // List&lt;PropertyType&gt; completeProperties =
        // dh.openBisClient.listPropertiesForType(dh.openBisClient.getSampleTypeByString(s.getType()));


        Object mother_node =
            graph.insertVertex(parent, s.getIdentifier(),
                String.format(&quot;%s\n%s&quot;, s.getCode(), species), 20, 20, width, height,
                &quot;ROUNDED;strokeColor=#ffffff;fillColor=#0365C0&quot;);
        // subtree_vertices.add(mother_node);
        List&lt;Sample&gt; children = new ArrayList&lt;Sample&gt;();

        // children.addAll(this.open_client.getFacade().listSamplesOfSample(s.getPermId()));
        // children.addAll(dh.openBisClient.getFacade().listSamplesOfSample(s.getPermId()));

        children.addAll(s.getChildren());


        // Object group_node = graph.insertVertex(parent, null, &quot;Entities&quot;, 20, 20, width, height);

        for (Sample c : children) {

          if (c.getSampleTypeCode().equals(&quot;Q_BIOLOGICAL_SAMPLE&quot;)) {

            String primaryTissue = &quot;&quot;;
            String secondaryName = &quot;&quot;;
            for (PropertyType pType : bioSampleProperties) {
              if (pType.getCode().equals(&quot;Q_PRIMARY_TISSUE&quot;)) {
                primaryTissue =</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/DifferentialExpressionComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DifferentialExpressionComponent.html#L63">63</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/NGSMappingComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/NGSMappingComponent.html#L74">74</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    return inputFileComponent.getSelectedDatasetsAsMap();
  }

  public Workflow getWorkflow() {
    Workflow tmp = parameterComponent.getWorkflow();
    boolean success = inputFileComponent.updateWorkflow(tmp, controller);
    return success ? tmp : null;
  }

  public void update(Workflow workflow, BeanItemContainer&lt;DatasetBean&gt; input) {
    this.inputFileComponent.buildLayout(workflow.getData().getData(), input);
    this.parameterComponent.buildLayout(workflow);
  }

  public void resetParameters() {
    parameterComponent.resetParameters();
  }

  public void addResetListener(ClickListener listener) {
    reset.addClickListener(listener);
  }

  public void addSubmissionListener(ClickListener listener) {
    submit.addClickListener(listener);
  }

  public void writeParametersToWorkflow() throws IllegalArgumentException, JSONException {
    if (parameterComponent.getWorkflow() instanceof GuseWorkflowRepresentation) {
      GuseWorkflowRepresentation w = (GuseWorkflowRepresentation) parameterComponent.getWorkflow();

      String header = &quot;filename\tQBIC_ID\tinternal_ID\ttreatment\ttime\tgroup\tbio_rep&quot;;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/PatientStatusComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/PatientStatusComponent.html#L219">219</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L887">887</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          Utils.Notification(&quot;Not available.&quot;, &quot;Workflow not available or no workflow selected.&quot;, &quot;General&quot;);
        }
      }
    }));

    experiments.getColumn(&quot;started&quot;).setRenderer(new HtmlRenderer());

    ProgressBar progressBar = new ProgressBar();
    progressBar.setCaption(&quot;Overall Progress&quot;);
    progressBar.setWidth(Page.getCurrent().getBrowserWindowWidth() * 0.6f, Unit.PIXELS);
    progressBar.setStyleName(&quot;patientprogress&quot;);

    status.addComponent(progressBar);
    status.addComponent(experiments);
    status.setComponentAlignment(progressBar, Alignment.MIDDLE_CENTER);
    status.setComponentAlignment(experiments, Alignment.MIDDLE_CENTER);


    /**
     * Defined Experiments for iVac - Barcodes available -&gt; done with project creation (done) -
     * Sequencing done (Status Q_NGS_MEASUREMENT) - Variants annotated (Status
     * Q_NGS_VARIANT_CALLING) - HLA Typing done (STATUS Q_NGS_WF_HLA_TYPING) - Epitope Prediction
     * done (STATUS Q_WF_NGS_EPITOPE_PREDICTION)
     */


    for (Iterator i = experimentstatusBeans.getItemIds().iterator(); i.hasNext();) {
      ExperimentStatusBean statusBean = (ExperimentStatusBean) i.next();

      finishedExperiments += statusBean.getStatus();

      // statusBean.setDownload(&quot;Download&quot;);
      statusBean.setWorkflow(&quot;Run&quot;);
    }


    progressBar.setValue((float) finishedExperiments / experimentstatusBeans.size());
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.html#L65">65</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.html#L87">87</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public ChangeExperimentMetadataComponent(DataHandler dh, State state, String resourceurl) {
    this.datahandler = dh;
    this.resourceUrl = resourceurl;
    this.state = state;

    // this.setCaption(&quot;Metadata&quot;);

    this.initUI();
  }

  private void initUI() {
    propLayout = new VerticalLayout();
    propLayout.setWidth(100.0f, Unit.PERCENTAGE);
    propLayout.setMargin(new MarginInfo(true, false, true, true));
    propLayout.setSpacing(true);

    this.setWidth(Page.getCurrent().getBrowserWindowWidth() * 0.8f, Unit.PIXELS);
    this.setCompositionRoot(propLayout);
  }

  public void updateUI(final String id, String type) {
    propLayout.removeAllComponents();
    Button saveButton = new Button(&quot;Submit Changes&quot;);
    saveButton.setStyleName(ValoTheme.BUTTON_FRIENDLY);

    completeProperties = datahandler.getOpenBisClient()
        .listPropertiesForType(datahandler.getOpenBisClient().getExperimentTypeByString(type));</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.html#L168">168</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.html#L256">256</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.PropertyType p : completeProperties) {
      if (p instanceof ControlledVocabularyPropertyType) {

        ControlledVocabularyPropertyType controlled_vocab = (ControlledVocabularyPropertyType) p;
        List&lt;String&gt; terms = new ArrayList&lt;String&gt;();

        for (VocabularyTerm term : controlled_vocab.getTerms()) {
          terms.add(term.getCode().toString());
        }

        PropertyBean newVocab = new PropertyBean();
        newVocab.setCode(p.getCode());
        newVocab.setDescription(p.getDescription());
        newVocab.setLabel(p.getLabel());
        newVocab.setVocabularyValues(terms);

        controlledVocabularies.put(p.getCode(), newVocab);
      }
    }
    return controlledVocabularies;
  }


  private Map&lt;String, PropertyBean&gt; getProperties() {
    Map&lt;String, PropertyBean&gt; properties = new HashMap&lt;String, PropertyBean&gt;();
    for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.PropertyType p : completeProperties) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L170">170</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L371">371</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      datasetContainer.addContainerProperty(&quot;isDirectory&quot;, Boolean.class, null);
      datasetContainer.addContainerProperty(&quot;CODE&quot;, String.class, null);

      List&lt;ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet&gt; retrievedDatasetsAll = null;
      List&lt;ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet&gt; retrievedDatasets =
          new ArrayList&lt;ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet&gt;();
      Map&lt;String, ArrayList&lt;ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet&gt;&gt; datasetFilter =
          new HashMap&lt;String, ArrayList&lt;ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet&gt;&gt;();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L491">491</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L453">453</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      } else {

        Map&lt;String, String&gt; samples = new HashMap&lt;String, String&gt;();

        // project same for all datasets
        String projectCode = retrievedDatasets.get(0).getExperimentIdentifier().split(&quot;/&quot;)[2];
        for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet dataset : retrievedDatasets) {
          samples.put(dataset.getCode(), dataset.getSampleIdentifierOrNull().split(&quot;/&quot;)[2]);
        }

        List&lt;DatasetBean&gt; dsBeans = datahandler.queryDatasetsForFolderStructure(retrievedDatasets);

        for (DatasetBean d : dsBeans) {
          Date date = d.getRegistrationDate();
          SimpleDateFormat sd = new SimpleDateFormat(&quot;yyyy-MM-dd hh:mm a&quot;);
          String dateString = sd.format(date);
          // Timestamp ts = Timestamp.valueOf(dateString);
          String sampleID = samples.get(d.getCode());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/controllers/DataHandler.java</td>
<td><a href="./xref/life/qbic/projectbrowser/controllers/DataHandler.html#L780">780</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/controllers/DataHandler.java</td>
<td><a href="./xref/life/qbic/projectbrowser/controllers/DataHandler.html#L1118">1118</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        status = assignedProperties.get(&quot;Q_WF_STATUS&quot;);
      }

      List&lt;Sample&gt; samples = new ArrayList&lt;Sample&gt;();
      for (Sample s : allSamples) {
        if (s.getExperimentIdentifierOrNull().equals(experiment.getIdentifier()))
          samples.add(s);
      }
      BeanItemContainer&lt;SampleBean&gt; sampleBeans =
          new BeanItemContainer&lt;SampleBean&gt;(SampleBean.class);
      for (Sample sample : samples) {
        SampleBean sbean = new SampleBean();
        sbean.setId(sample.getIdentifier());
        sbean.setCode(sample.getCode());
        sbean.setType(sample.getSampleTypeCode());
        sbean.setProperties(sample.getProperties());
        List&lt;Property&gt; complexProps =
            studyParser.getFactorsAndPropertiesForSampleCode(experimentalSetup, sample.getCode());
        sbean.setComplexProperties(complexProps);
        sampleBeans.addBean(sbean);
      }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeMetadataComponent.html#L117">117</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.html#L254">254</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    Map&lt;String, PropertyBean&gt; controlledVocabularies = new HashMap&lt;String, PropertyBean&gt;();

    for (PropertyType p : completeProperties) {
      if (p instanceof ControlledVocabularyPropertyType) {

        ControlledVocabularyPropertyType controlled_vocab = (ControlledVocabularyPropertyType) p;
        List&lt;String&gt; terms = new ArrayList&lt;String&gt;();

        for (VocabularyTerm term : controlled_vocab.getTerms()) {
          terms.add(term.getCode().toString());
        }

        PropertyBean newVocab = new PropertyBean();
        newVocab.setCode(p.getCode());
        newVocab.setDescription(p.getDescription());
        newVocab.setLabel(p.getLabel());
        newVocab.setVocabularyValues(terms);

        controlledVocabularies.put(p.getCode(), newVocab);
      }
    }
    return controlledVocabularies;
  }


  private Map&lt;String, PropertyBean&gt; getProperties(SampleBean currentBean) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L226">226</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L257">257</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>                newBean.setAdditionalInfo(sampleProperties.get(&quot;Q_ADDITIONAL_INFO&quot;));
                newBean.setExternalDB(sampleProperties.get(&quot;Q_EXTERNALDB_ID&quot;));
                newBean.setSecondaryName(sampleProperties.get(&quot;Q_SECONDARY_NAME&quot;));

                List&lt;Property&gt; complexProps = xmlParser.getFactorsAndPropertiesForSampleCode(
                    datahandler.getExperimentalSetup(), sample.getCode());
                newBean.setProperties(sampleProperties, complexProps);

                samplesContainer.addBean(newBean);

                ArrayList&lt;ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet&gt; foundDataset =
                    datasetFilter.get(sample.getIdentifier());

                if (foundDataset != null) {
                  retrievedDatasets.addAll(foundDataset);
                }

                for (Sample child : sample.getChildren()) {
                  foundDataset = datasetFilter.get(child.getIdentifier());
                  if (foundDataset != null) {
                    retrievedDatasets.addAll(foundDataset);
                  }
                }
              } else if (sample.getSampleTypeCode().equals(&quot;Q_MHC_LIGAND_EXTRACT&quot;)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/WorkflowComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/WorkflowComponent.html#L111">111</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/WorkflowView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/WorkflowView.html#L115">115</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    viewContent.setMargin(true);

    // select available workflows
    workflows = new VerticalLayout();
    VerticalLayout workflowsContent = new VerticalLayout();
    workflows.setMargin(new MarginInfo(false, true, true, false));

    workflowsContent.addComponent(availableWorkflows);
    availableWorkflows.setSizeFull();
    availableWorkflows.setDescription(WORKFKLOW_GRID_DESCRIPTION);
    // availableWorkflows.setWidth(&quot;100%&quot;);
    workflows.setVisible(false);

    workflows.setCaption(&quot;Available Workflows&quot;);
    workflows.setIcon(FontAwesome.EXCHANGE);
    workflows.addComponent(workflowsContent);
    workflows.setWidth(100.0f, Unit.PERCENTAGE);

    // submission
    submission = new VerticalLayout();
    submission.setMargin(new MarginInfo(false, true, true, false));


    submission.setCaption(SUBMISSION_CAPTION);
    submission.setIcon(FontAwesome.PLAY);
    submission.setWidth(100.0f, Unit.PERCENTAGE);
    submission.setVisible(false);

    // add sections to layout
    viewContent.addComponent(workflows);
    viewContent.addComponent(submission);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.html#L193">193</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.html#L281">281</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.PropertyType p : completeProperties) {
      if (p.getDataType().toString().equals(&quot;XML&quot;)) {
        continue;
      } else if (assignedProperties.keySet().contains(p.getCode())) {
        properties.put(p.getCode(), new PropertyBean(p.getLabel(), p.getCode(), p.getDescription(),
            assignedProperties.get(p.getCode())));
      } else {
        properties.put(p.getCode(),
            new PropertyBean(p.getLabel(), p.getCode(), p.getDescription(), &quot;&quot;));
      }
    }
    return properties;

  }

  private List&lt;Property&gt; getXMLProperties() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/GraphGenerator.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/GraphGenerator.html#L73">73</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/GraphGenerator.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/GraphGenerator.html#L378">378</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public GraphGenerator(ProjectBean projectBean, OpenBisClient openBisClient) throws IOException {
    // super(&quot;openBIS graph&quot;);


    // Project p = dh.openBisClient.getProjectByCode(project);

    // Project p = dh.openBisClient.getProjectByIdentifier(projectBean);
    // System.out.println(p);

    mxGraph graph = new mxGraph();
    Object parent = graph.getDefaultParent();
    graph.getModel().beginUpdate();

    mxStylesheet stylesheet = graph.getStylesheet();
    Hashtable&lt;String, Object&gt; style = new Hashtable&lt;String, Object&gt;();
    style.put(mxConstants.STYLE_SHAPE, mxConstants.SHAPE_RECTANGLE);
    style.put(mxConstants.STYLE_OPACITY, 100);
    style.put(mxConstants.STYLE_FONTCOLOR, &quot;#ffffff&quot;);
    style.put(mxConstants.STYLE_DIRECTION, &quot;east&quot;);
    stylesheet.putCellStyle(&quot;ROUNDED&quot;, style);


    Double width = new Double(120.0);
    Double height = new Double(40.0);



    try {
      // Object found_project = graph.insertVertex(parent, null, p.getIdentifier(), 20, 20, 120,
      // height,&quot;ROUNDED;strokeColor=#005FAA;fillColor=#005FAA&quot;);
      // Object dummy_node = graph.insertVertex(parent, null, &quot;HALLO&quot;, 50,20,120,height, &quot;ROUNDED&quot;);

      // could be done more efficiently with SearchCriteria (at least I hope so)
      Map&lt;String, Integer&gt; sample_count = new HashMap&lt;String, Integer&gt;();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L378">378</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L199">199</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        buttonLayout.setResponsive(true);

        // final Button visualize = new Button(VISUALIZE_BUTTON_CAPTION);

        Button checkAll = new Button(&quot;Select all datasets&quot;);
        checkAll.addClickListener(new ClickListener() {

            @Override
            public void buttonClick(ClickEvent event) {
                for (Object itemId : table.getItemIds()) {
                    ((CheckBox) table.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue()).setValue(true);
                }
            }
        });

        Button uncheckAll = new Button(&quot;Unselect all datasets&quot;);
        uncheckAll.addClickListener(new ClickListener() {

            @Override
            public void buttonClick(ClickEvent event) {
                for (Object itemId : table.getItemIds()) {
                    ((CheckBox) table.getItem(itemId).getItemProperty(&quot;Select&quot;).getValue()).setValue(false);
                }
            }
        });</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L493">493</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L777">777</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>                            StreamResource streamres = new StreamResource(re, datasetFileName);
                            // streamres.setMIMEType(&quot;application/png&quot;);
                            res = streamres;
                            visualize = true;
                        }

                        if (datasetFileName.endsWith(&quot;.qcML&quot;)) {
                            QcMlOpenbisSource re = new QcMlOpenbisSource(url);
                            StreamResource streamres = new StreamResource(re, datasetFileName);
                            streamres.setMIMEType(&quot;text/xml&quot;);
                            res = streamres;
                            visualize = true;
                        }

                        if (datasetFileName.endsWith(&quot;.alleles&quot;)) {
                            QcMlOpenbisSource re = new QcMlOpenbisSource(url);
                            StreamResource streamres = new StreamResource(re, datasetFileName);
                            streamres.setMIMEType(&quot;text/plain&quot;);
                            res = streamres;
                            visualize = true;
                        }

                        if (datasetFileName.endsWith(&quot;.tsv&quot;)) {
                            QcMlOpenbisSource re = new QcMlOpenbisSource(url);
                            StreamResource streamres = new StreamResource(re, datasetFileName);
                            streamres.setMIMEType(&quot;text/plain&quot;);
                            res = streamres;
                            visualize = true;
                        }

                        if (datasetFileName.endsWith(&quot;.GSvar&quot;)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L304">304</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L351">351</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        &quot;getClientDatasetsOfProjectByIdentifierWithSearchCriteria took %f s&quot;,
        ((endTime - startTime) / 1000000000.0)));
    startTime = System.nanoTime();
    List&lt;String&gt; codes = new ArrayList&lt;String&gt;();
    for (DataSet dataset : datasets) {
      codes.add(dataset.getCode());
    }
    Map&lt;String, List&lt;String&gt;&gt; params = new HashMap&lt;String, List&lt;String&gt;&gt;();
    params.put(&quot;codes&quot;, codes);
    QueryTableModel res = openbisClient.queryFileInformation(params);
    endTime = System.nanoTime();
    LOG.debug(String.format(&quot;getAggregationService took %f s&quot;,
        ((endTime - startTime) / 1000000000.0)));
    download(res, writer, response, openbisClient, bean.getCode());
  }

  void serveExperiment2(ExperimentBean bean, TarWriter writer, ResourceResponse response,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeMetadataComponent.html#L148">148</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.html#L280">280</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    Map&lt;String, String&gt; assignedProperties = currentBean.getProperties();

    for (PropertyType p : completeProperties) {
      if (p.getDataType().toString().equals(&quot;XML&quot;)) {
        continue;
      } else if (assignedProperties.keySet().contains(p.getCode())) {
        // properties.put(p.getCode(), assignedProperties.get(p.getCode()));
        properties.put(p.getCode(), new PropertyBean(p.getLabel(), p.getCode(), p.getDescription(),
            assignedProperties.get(p.getCode())));
      } else {
        properties.put(p.getCode(),
            new PropertyBean(p.getLabel(), p.getCode(), p.getDescription(), &quot;&quot;));
      }
    }
    return properties;

  }

  private void buildFormLayout(SampleBean sample) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/model/BiologicalEntitySampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/BiologicalEntitySampleBean.html#L110">110</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/model/TestSampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/TestSampleBean.html#L110">110</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    return id.compareTo(((BiologicalEntitySampleBean) o).getId());
  }

  @Override
  public boolean equals(Object o) {
    if (o instanceof SampleBean) {
      SampleBean b = (SampleBean) o;
      return id.equals(b.getId());
    } else
      return false;
  }

  @Override
  public int hashCode() {
    return id.hashCode();
  }

  public String getSecondaryName() {
    return secondaryName;
  }

  public void setSecondaryName(String secondaryName) {
    this.secondaryName = secondaryName;
  }

  public String getAdditionalInfo() {
    return additionalInfo;
  }

  public void setAdditionalInfo(String additionalInfo) {
    this.additionalInfo = additionalInfo;
  }

  public String getExternalDB() {
    return externalDB;
  }

  public void setExternalDB(String externalDB) {
    this.externalDB = externalDB;
  }


  public String getProperties() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.html#L193">193</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ChangeMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeMetadataComponent.html#L150">150</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.PropertyType p : completeProperties) {
      if (p.getDataType().toString().equals(&quot;XML&quot;)) {
        continue;
      } else if (assignedProperties.keySet().contains(p.getCode())) {
        properties.put(p.getCode(), new PropertyBean(p.getLabel(), p.getCode(), p.getDescription(),
            assignedProperties.get(p.getCode())));
      } else {
        properties.put(p.getCode(),
            new PropertyBean(p.getLabel(), p.getCode(), p.getDescription(), &quot;&quot;));
      }
    }
    return properties;

  }

  private List&lt;Property&gt; getXMLProperties() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/model/SearchResultsExperimentBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/SearchResultsExperimentBean.html#L66">66</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/model/SearchResultsSampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/SearchResultsSampleBean.html#L67">67</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    String code = e.getCode();

    for (String str : queryComponents) {
      Pattern tmpPattern = Pattern.compile(str, Pattern.CASE_INSENSITIVE + Pattern.LITERAL);
      Matcher patternMatch = tmpPattern.matcher(code);

      if (patternMatch.find()) {
        strbuild.append(&quot;code: &quot; + code + &quot;,&quot;);
      }

      for (String k : props.keySet()) {
        if (k.equals(&quot;Q_SECONDARY_NAME&quot;)) {
          continue;
        }

        if (k.equals(&quot;Q_PROPERTIES&quot;)) {
          Map&lt;String, String&gt; xmlPropsMap = new HashMap&lt;String, String&gt;();
          try {
            xmlPropsMap = parseXMLString(props.get(k).trim());
          } catch (Exception ex) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L1178">1178</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/ProjectView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/ProjectView.html#L879">879</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  @Override
  public void enter(ViewChangeEvent event) {
    String currentValue = event.getParameters();
    OpenBisClient oc = datahandler.getOpenBisClient();
    List&lt;Project&gt; userProjects = oc.getOpenbisInfoService().listProjectsOnBehalfOfUser(
        oc.getSessionToken(), PortalUtils.getNonNullScreenName());

    List&lt;String&gt; projectIDs = new ArrayList&lt;String&gt;();

    for (Project p : userProjects) {
      projectIDs.add(p.getIdentifier());
    }

    if (projectIDs.contains(currentValue)) {
      // TODO updateContent only if currentProject is not equal to newProject
      // this.table.unselect(this.table.getValue());
      ProjectBean pbean = datahandler.getProject2(currentValue);
      // if the new project bean is different than reset the graph.
      if (currentBean != null &amp;&amp; !pbean.getId().equals(currentBean.getId())) {
        resetGraphs();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.html#L168">168</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ChangeMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeMetadataComponent.html#L119">119</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.PropertyType p : completeProperties) {
      if (p instanceof ControlledVocabularyPropertyType) {

        ControlledVocabularyPropertyType controlled_vocab = (ControlledVocabularyPropertyType) p;
        List&lt;String&gt; terms = new ArrayList&lt;String&gt;();

        for (VocabularyTerm term : controlled_vocab.getTerms()) {
          terms.add(term.getCode().toString());
        }

        PropertyBean newVocab = new PropertyBean();
        newVocab.setCode(p.getCode());
        newVocab.setDescription(p.getDescription());
        newVocab.setLabel(p.getLabel());
        newVocab.setVocabularyValues(terms);

        controlledVocabularies.put(p.getCode(), newVocab);
      }
    }
    return controlledVocabularies;
  }


  private Map&lt;String, PropertyBean&gt; getProperties() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/SearchBarView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/SearchBarView.html#L171">171</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/SearchEngineView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/SearchEngineView.html#L361">361</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  public List&lt;String&gt; getSearchResults(String samplecode) {
    EnumSet&lt;SampleFetchOption&gt; fetchOptions = EnumSet.of(SampleFetchOption.PROPERTIES);
    SearchCriteria sc = new SearchCriteria();
    sc.addMatchClause(
        MatchClause.createAttributeMatch(MatchClauseAttribute.CODE, samplecode + &quot;*&quot;));
    List&lt;Sample&gt; samples = datahandler.getOpenBisClient().getOpenbisInfoService()
        .searchForSamplesOnBehalfOfUser(datahandler.getOpenBisClient().getSessionToken(), sc,
            fetchOptions, PortalUtils.getNonNullScreenName());
    List&lt;String&gt; ret = new ArrayList&lt;String&gt;(samples.size());
    for (Sample sample : samples) {
      ret.add(sample.getCode());
    }
    return ret;
  }
}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L490">490</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L550">550</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            &quot;warning&quot;);
      } else {

        Map&lt;String, String&gt; samples = new HashMap&lt;String, String&gt;();

        // project same for all datasets
        String projectCode = retrievedDatasets.get(0).getExperimentIdentifier().split(&quot;/&quot;)[2];
        for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet dataset : retrievedDatasets) {
          samples.put(dataset.getCode(), dataset.getSampleIdentifierOrNull().split(&quot;/&quot;)[2]);
        }

        List&lt;DatasetBean&gt; dsBeans = datahandler.queryDatasetsForFolderStructure(retrievedDatasets);

        for (DatasetBean d : dsBeans) {
          Date date = d.getRegistrationDate();
          SimpleDateFormat sd = new SimpleDateFormat(&quot;yyyy-MM-dd hh:mm a&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/SampleView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/SampleView.html#L387">387</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/SampleView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/SampleView.html#L474">474</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    int numberOfDatasets = currentBean.getDatasets().size();
    // numberOfDatasetsLabel.setValue(String.format(&quot;This sample has %s attached dataset(s) &quot;,
    // numberOfDatasets));
    if (numberOfDatasets &gt; 0) {

      String lastDataset = &quot;&quot;;// &quot;No Datasets available!&quot;;
      if (currentBean.getLastChangedDataset() != null) {
        lastDataset = currentBean.getLastChangedDataset().toString();
        lastChangedDatasetLabel.setValue(String.format(&quot;Last Change: %s&quot;,
            String.format(&quot;Dataset added on %s&quot;, lastDataset)));
      } else {
        lastChangedDatasetLabel.setValue(lastDataset);
      }
    }

    try {
      propertiesLabel.setValue(currentBean.generatePropertiesFormattedString());
      experimentalFactorLabel.setValue(currentBean.generateXMLPropertiesFormattedString());
    } catch (JAXBException e) {
      LOG.error(
          String.format(&quot;failed to parse experimental factors for sample %s&quot;, currentBean.getId()),
          e);
    }
  }

  /**
   * 
   * @return
   * 
   */
  VerticalLayout initStatistics() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L195">195</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L385">385</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          retrievedDatasetsAll = datahandler.getOpenBisClient()
              .getDataSetsOfProjectByIdentifierWithSearchCriteria(projectIdentifier);

          for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet ds : retrievedDatasetsAll) {

            ArrayList&lt;ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet&gt; values =
                datasetFilter.get(ds.getSampleIdentifierOrNull());

            if (values == null) {
              values = new ArrayList&lt;ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet&gt;();
              datasetFilter.put(ds.getSampleIdentifierOrNull(), values);
            }
            values.add(ds);
          }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L453">453</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L551">551</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      } else {

        Map&lt;String, String&gt; samples = new HashMap&lt;String, String&gt;();

        // project same for all datasets
        String projectCode = retrievedDatasets.get(0).getExperimentIdentifier().split(&quot;/&quot;)[2];
        for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet dataset : retrievedDatasets) {
          samples.put(dataset.getCode(), dataset.getSampleIdentifierOrNull().split(&quot;/&quot;)[2]);
        }

        List&lt;DatasetBean&gt; dsBeans = datahandler.queryDatasetsForFolderStructure(retrievedDatasets);

        for (DatasetBean d : dsBeans) {
          Date date = d.getRegistrationDate();
          SimpleDateFormat sd = new SimpleDateFormat(&quot;yyyy-MM-dd hh:mm a&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L686">686</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L289">289</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    this.datasetTable.addValueChangeListener(new ValueChangeListener() {
      /**
       * 
       */
      private static final long serialVersionUID = -3554627008191389648L;

      @Override
      public void valueChange(ValueChangeEvent event) {
        // Nothing selected or more than one selected.
        Set&lt;Object&gt; selectedValues = (Set&lt;Object&gt;) event.getProperty().getValue();
        State state = (State) UI.getCurrent().getSession().getAttribute(&quot;state&quot;);
        ArrayList&lt;String&gt; message = new ArrayList&lt;String&gt;();
        message.add(&quot;DataSetView&quot;);
        if (selectedValues != null &amp;&amp; selectedValues.size() == 1) {
          Iterator&lt;Object&gt; iterator = selectedValues.iterator();
          Object next = iterator.next();
          String datasetType =
              (String) datasetTable.getItem(next).getItemProperty(&quot;Dataset Type&quot;).getValue();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L1037">1037</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L529">529</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        MatchClause.createAttributeMatch(MatchClauseAttribute.PROJECT, projectBean.getCode()));
    sc.addSubCriteria(SearchSubCriteria.createExperimentCriteria(projectSc));

    SearchCriteria experimentSc = new SearchCriteria();
    experimentSc.addMatchClause(MatchClause.createAttributeMatch(MatchClauseAttribute.TYPE,
        ExperimentType.Q_NGS_HLATYPING.name()));
    sc.addSubCriteria(SearchSubCriteria.createExperimentCriteria(experimentSc));


    List&lt;Sample&gt; samples = datahandler.getOpenBisClient().getFacade().searchForSamples(sc);

    SearchCriteria sc2 = new SearchCriteria();
    sc2.addMatchClause(MatchClause.createAttributeMatch(MatchClauseAttribute.TYPE,
        ExperimentType.Q_WF_NGS_HLATYPING.name()));
    SearchCriteria projectSc2 = new SearchCriteria();
    projectSc2.addMatchClause(
        MatchClause.createAttributeMatch(MatchClauseAttribute.PROJECT, projectBean.getCode()));</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/model/BiologicalEntitySampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/BiologicalEntitySampleBean.html#L149">149</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/model/BiologicalSampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/BiologicalSampleBean.html#L152">152</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/model/TestSampleBean.java</td>
<td><a href="./xref/life/qbic/projectbrowser/model/TestSampleBean.html#L157">157</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }


  public String getProperties() {
    return properties;
  }

  public void setProperties(Map&lt;String, String&gt; properties, List&lt;Property&gt; complexProps) {
    try {
      this.properties = generateXMLPropertiesFormattedString(complexProps);
    } catch (JAXBException e) {
      // TODO Auto-generated catch block
      e.printStackTrace();
    }
  }

  public String generateXMLPropertiesFormattedString(List&lt;Property&gt; properties)
      throws JAXBException {

    String xmlPropertiesString = &quot;&quot;;

    for (Property p : properties) {
      xmlPropertiesString += p.getLabel() + &quot;: &quot; + p.getValue();
      if (p.hasUnit()) {
        xmlPropertiesString += &quot; &quot; + p.getUnit();
      }
      xmlPropertiesString += &quot; &quot;;
    }
    return xmlPropertiesString;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L1087">1087</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/ProjectView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/ProjectView.html#L726">726</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        new ViewTablesClickListener(registeredExperiments, ExperimentView.navigateToLabel));
  }

  /**
   * initializes and builds a filtering table for this view
   * 
   * @return
   */
  private FilterTable buildFilterTable() {
    FilterTable filterTable = new FilterTable();

    filterTable.setFilterDecorator(new DatasetViewFilterDecorator());
    filterTable.setFilterGenerator(new DatasetViewFilterGenerator());

    filterTable.setFilterBarVisible(true);

    filterTable.setSelectable(true);
    filterTable.setImmediate(true);

    filterTable.setRowHeaderMode(RowHeaderMode.INDEX);

    filterTable.setColumnCollapsingAllowed(true);

    filterTable.setColumnReorderingAllowed(true);

    filterTable.setColumnHeader(&quot;code&quot;, &quot;Name&quot;);
    filterTable.setColumnHeader(&quot;type&quot;, &quot;Type&quot;);
    filterTable.setColumnHeader(&quot;registrationDate&quot;, &quot;Registration Date&quot;);
    filterTable.setColumnHeader(&quot;registrator&quot;, &quot;Registered By&quot;);
    filterTable.setColumnHeader(&quot;status&quot;, &quot;Status&quot;);

    return filterTable;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L523">523</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L798">798</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                        if (datasetFileName.endsWith(&quot;.GSvar&quot;)) {
                            QcMlOpenbisSource re = new QcMlOpenbisSource(url);
                            StreamResource streamres = new StreamResource(re, datasetFileName);
                            streamres.setMIMEType(&quot;text/plain&quot;);
                            res = streamres;
                            visualize = true;
                        }

                        if (datasetFileName.endsWith(&quot;.log&quot;)) {
                            QcMlOpenbisSource re = new QcMlOpenbisSource(url);
                            StreamResource streamres = new StreamResource(re, datasetFileName);
                            streamres.setMIMEType(&quot;text/plain&quot;);
                            res = streamres;
                            visualize = true;
                        }

                        if (datasetFileName.endsWith(&quot;.html&quot;)) {
                            QcMlOpenbisSource re = new QcMlOpenbisSource(url);
                            StreamResource streamres = new StreamResource(re, datasetFileName);
                            streamres.setMIMEType(&quot;text/html&quot;);
                            res = streamres;
                            visualize = true;
                        }

                        if (visualize) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L473">473</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L756">756</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                        }

                        Window subWindow = new Window();
                        VerticalLayout subContent = new VerticalLayout();
                        subContent.setMargin(true);
                        subContent.setSizeFull();
                        subWindow.setContent(subContent);
                        ProjectBrowserPortlet ui = (ProjectBrowserPortlet) UI.getCurrent();
                        Boolean visualize = false;

                        if (datasetFileName.endsWith(&quot;.pdf&quot;)) {
                            QcMlOpenbisSource re = new QcMlOpenbisSource(url);
                            StreamResource streamres = new StreamResource(re, datasetFileName);
                            streamres.setMIMEType(&quot;application/pdf&quot;);
                            res = streamres;
                            visualize = true;
                        }

                        if (datasetFileName.endsWith(&quot;.png&quot;)) {
                            QcMlOpenbisSource re = new QcMlOpenbisSource(url);
                            StreamResource streamres = new StreamResource(re, datasetFileName);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L418">418</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L695">695</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        PopupView tooltip = new PopupView(new ToolTip(content));
        tooltip.setHeight(&quot;44px&quot;);

        HorizontalLayout help = new HorizontalLayout();
        help.setSizeFull();
        HorizontalLayout helpContent = new HorizontalLayout();
        // helpContent.setSizeFull();

        help.setMargin(new MarginInfo(false, false, false, true));
        Label helpText = new Label(&quot;Attention: Click here before Download!&quot;);
        helpContent.addComponent(new Label(FontAwesome.QUESTION_CIRCLE.getHtml(), ContentMode.HTML));
        helpContent.addComponent(helpText);
        helpContent.addComponent(tooltip);
        helpContent.setSpacing(true);

        help.addComponent(helpContent);
        help.setComponentAlignment(helpContent, Alignment.TOP_CENTER);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/ProjectView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/ProjectView.html#L475">475</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/SampleView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/SampleView.html#L512">512</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    tableSection.setWidth(Page.getCurrent().getBrowserWindowWidth() * 0.8f, Unit.PIXELS);
    tableSectionContent.setWidth(&quot;100%&quot;);

    tableSection.addComponent(tableSectionContent);

    this.export = new Button(&quot;Export as TSV&quot;);
    buttonLayoutSection = new VerticalLayout();
    HorizontalLayout buttonLayout = new HorizontalLayout();
    buttonLayout.setHeight(null);
    buttonLayout.setWidth(&quot;100%&quot;);
    buttonLayout.addComponent(this.export);
    buttonLayout.setMargin(new MarginInfo(false, false, true, false));
    buttonLayoutSection.addComponent(buttonLayout);
    buttonLayoutSection.setSpacing(true);
    buttonLayoutSection.setMargin(new MarginInfo(false, false, true, true));

    tableSection.addComponent(buttonLayoutSection);

    return tableSection;
  }


  /**
   * 
   */
  void updateContentTable() {
    // Nothing to do here at the moment
    // table is already set in setdataresource
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/GraphGenerator.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/GraphGenerator.html#L310">310</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/GraphGenerator.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/GraphGenerator.html#L582">582</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                              measuredSecID), 20, 20, width + 50, height + 20,
                          &quot;ROUNDED;strokeColor=#ffffff;fillColor=#F39019&quot;);
                  graph.insertEdge(parent, null, &quot;&quot;, granddaughter_node, grandgranddaughter_node);

                }
              }
            }
          }
        }
      }

      mxHierarchicalLayout layout = new mxHierarchicalLayout(graph, SwingConstants.WEST);
      layout.setDisableEdgeStyle(true);
      // layout.setInterHierarchySpacing(10);
      layout.setInterRankCellSpacing(100);


      // mxIGraphLayout layout = new mxFastOrganicLayout(graph);

      layout.execute(graph.getDefaultParent()); // Run the layout on the facade.\n

      // mxGraphComponent graphComponent = new mxGraphComponent(graph);
      // getContentPane().add(graphComponent);

      BufferedImage image =
          mxCellRenderer.createBufferedImage(graph, null, 1, Color.WHITE, true, null);

      // String url = VaadinService.getCurrent().getBaseDirectory().getAbsolutePath() +
      // &quot;/WEB-INF/images/graph.png&quot;;
      // this.url = url;
      final ByteArrayOutputStream bas = new ByteArrayOutputStream();

      if (image != null) {
        ImageIO.write(image, &quot;PNG&quot;, bas);
        this.res = showFile(projectBean.getId(), &quot;PNG&quot;, bas);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/BiologicalSamplesComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/BiologicalSamplesComponent.html#L132">132</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/BiologicalSamplesComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/BiologicalSamplesComponent.html#L175">175</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    vert.setMargin(new MarginInfo(false, true, false, false));

    sampleEntityGrid.addSelectionListener(new SelectionListener() {

      @Override
      public void select(SelectionEvent event) {
        BeanItem&lt;BiologicalEntitySampleBean&gt; selectedBean =
            samplesEntity.getItem(sampleEntityGrid.getSelectedRow());

        if (selectedBean == null) {
          TextField filterField =
              (TextField) sampleBioGrid.getHeaderRow(1).getCell(&quot;biologicalEntity&quot;).getComponent();
          filterField.setValue(&quot;&quot;);
        } else {
          TextField filterField =
              (TextField) sampleBioGrid.getHeaderRow(1).getCell(&quot;biologicalEntity&quot;).getComponent();
          filterField.setValue(selectedBean.getBean().getCode());
          // samplesBio.addContainerFilter(&quot;biologicalEntity&quot;,
          // selectedBean.getBean().getSecondaryName(), false, false);
        }
      }

    });</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L611">611</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/SampleView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/SampleView.html#L512">512</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    tableSection.setWidth(&quot;100%&quot;);
    tableSectionContent.setWidth(&quot;100%&quot;);

    tableSection.addComponent(tableSectionContent);

    this.export = new Button(&quot;Export as TSV&quot;);
    buttonLayoutSection = new VerticalLayout();
    HorizontalLayout buttonLayout = new HorizontalLayout();
    buttonLayout.setHeight(null);
    buttonLayout.setWidth(&quot;100%&quot;);
    buttonLayout.addComponent(this.export);
    buttonLayout.setMargin(new MarginInfo(false, false, true, false));
    buttonLayoutSection.addComponent(buttonLayout);
    buttonLayoutSection.setSpacing(true);
    buttonLayoutSection.setMargin(new MarginInfo(false, false, true, true));

    tableSection.addComponent(buttonLayoutSection);

    return tableSection;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L300">300</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L429">429</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            });

            sampleGrid.addItemClickListener(new ItemClickListener() {

              @Override
              public void itemClick(ItemClickEvent event) {

                BeanItem selected = (BeanItem) samples.getItem(event.getItemId());
                TestSampleBean selectedExp = (TestSampleBean) selected.getBean();

                State state = (State) UI.getCurrent().getSession().getAttribute(&quot;state&quot;);
                ArrayList&lt;String&gt; message = new ArrayList&lt;String&gt;();
                message.add(&quot;clicked&quot;);
                message.add(selectedExp.getId());
                message.add(&quot;sample&quot;);
                state.notifyObservers(message);
              }
            });</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/GraphGenerator.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/GraphGenerator.html#L149">149</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/GraphGenerator.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/GraphGenerator.html#L427">427</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          List&lt;Sample&gt; tmp = s.getParents();
          num_measurement_samples += tmp.size();
        }

        if (key.equals(&quot;Q_BIOLOGICAL_ENTITY&quot;)) {
          samps.add(s);
        }
      }

      if (sample_count.containsKey(&quot;Q_BIOLOGICAL_ENTITY&quot;)) {
        Object dummy_node_level1 =
            graph.insertVertex(parent, null, sample_count.get(&quot;Q_BIOLOGICAL_ENTITY&quot;) + &quot;\n&quot;
                + &quot;biological entities&quot;, 20, 20, width, height,
                &quot;NONE;strokeWidth=0;strokeColor=#FFFFFF;fillColor=#FFFFFF&quot;);


        if (sample_count.containsKey(&quot;Q_BIOLOGICAL_SAMPLE&quot;)) {
          Object dummy_node_level2 =
              graph.insertVertex(parent, null, sample_count.get(&quot;Q_BIOLOGICAL_SAMPLE&quot;) + &quot;\n&quot;
                  + &quot;biological samples&quot;, 20, 20, width + 50, height,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L611">611</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/ProjectView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/ProjectView.html#L475">475</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    tableSection.setWidth(&quot;100%&quot;);
    tableSectionContent.setWidth(&quot;100%&quot;);

    tableSection.addComponent(tableSectionContent);

    this.export = new Button(&quot;Export as TSV&quot;);
    buttonLayoutSection = new VerticalLayout();
    HorizontalLayout buttonLayout = new HorizontalLayout();
    buttonLayout.setHeight(null);
    buttonLayout.setWidth(&quot;100%&quot;);
    buttonLayout.addComponent(this.export);
    buttonLayout.setMargin(new MarginInfo(false, false, true, false));
    buttonLayoutSection.addComponent(buttonLayout);
    buttonLayoutSection.setSpacing(true);
    buttonLayoutSection.setMargin(new MarginInfo(false, false, true, true));

    tableSection.addComponent(buttonLayoutSection);

    return tableSection;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L136">136</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L161">161</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L362">362</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            datasetContainer.addContainerProperty(&quot;Description&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;File Name&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;File Type&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;Dataset Type&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;Registration Date&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;Validated&quot;, Boolean.class, null);
            datasetContainer.addContainerProperty(&quot;File Size&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;file_size_bytes&quot;, Long.class, null);
            datasetContainer.addContainerProperty(&quot;dl_link&quot;, String.class, null);
            datasetContainer.addContainerProperty(&quot;isDirectory&quot;, Boolean.class, null);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L1053">1053</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L545">545</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        MatchClause.createAttributeMatch(MatchClauseAttribute.PROJECT, projectBean.getCode()));
    sc2.addSubCriteria(SearchSubCriteria.createExperimentCriteria(projectSc2));

    SearchCriteria experimentSc2 = new SearchCriteria();
    experimentSc2.addMatchClause(MatchClause.createAttributeMatch(MatchClauseAttribute.TYPE,
        ExperimentType.Q_WF_NGS_HLATYPING.name()));
    sc2.addSubCriteria(SearchSubCriteria.createExperimentCriteria(experimentSc2));

    List&lt;Experiment&gt; wfExperiments =
        datahandler.getOpenBisClient().getFacade().searchForExperiments(sc2);

    List&lt;Sample&gt; wfSamples = new ArrayList&lt;Sample&gt;();

    for (Experiment exp : wfExperiments) {
      if (exp.getCode().contains(projectBean.getCode())) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L1023">1023</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/ProjectView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/ProjectView.html#L545">545</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    graphSection.setSpacing(true);
    graphSection.setWidth(&quot;100%&quot;);
    graphSectionContent.setWidth(&quot;100%&quot;);

    OpenBisClient openbis = datahandler.getOpenBisClient();
    Map&lt;String, String&gt; taxMap = openbis.getVocabCodesAndLabelsForVocab(&quot;Q_NCBI_TAXONOMY&quot;);
    Map&lt;String, String&gt; tissueMap = openbis.getVocabCodesAndLabelsForVocab(&quot;Q_PRIMARY_TISSUES&quot;);

    newGraphContent = new GraphPage(taxMap, tissueMap);

    graphSection.addComponent(graphSectionContent);
    graphTab.addTab(graphSection, &quot;Sample Graph&quot;);
    graphTab.addTab(newGraphContent, &quot;Sample Graph v2 (beta)&quot;);
    return graphTab;
  }

  public void processed() {
    UI.getCurrent().setPollInterval(-1);
  }

  class Worker extends Thread {
    private PatientView patientView;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeExperimentMetadataComponent.html#L115">115</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ChangeSampleMetadataComponent.html#L138">138</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            PropertyType type = (PropertyType) tf.getData();
            if (splt.length &gt; 1) {
              label = splt[0];
              life.qbic.xml.properties.Unit unit = life.qbic.xml.properties.Unit.valueOf(splt[1]);
              f = new Property(label, val, unit, type);
            } else {
              f = new Property(label, val, type);
            }
            factors.add(f);
          }

          else {
            props.put(field.getDescription(), field.getValue());
          }
        }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L235">235</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L255">255</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L399">399</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L463">463</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L514">514</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L565">565</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      Set&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; entrySet = entries.entrySet();
      Iterator&lt;Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt;&gt; it = entrySet.iterator();
      while (it.hasNext()) {
        Entry&lt;String, SimpleEntry&lt;String, Long&gt;&gt; entry = it.next();
        String entryKey = entry.getKey().replaceFirst(entry.getValue().getKey() + &quot;/&quot;, &quot;&quot;);
        String[] splittedFilePath = entryKey.split(&quot;/&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L248">248</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L491">491</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L453">453</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L551">551</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            } else {

                Map&lt;String, String&gt; samples = new HashMap&lt;String, String&gt;();

                // project same for all datasets
                String projectCode = retrievedDatasets.get(0).getExperimentIdentifier().split(&quot;/&quot;)[2];
                for (ch.systemsx.cisd.openbis.generic.shared.api.v1.dto.DataSet dataset : retrievedDatasets) {
                    samples.put(dataset.getCode(), dataset.getSampleIdentifierOrNull().split(&quot;/&quot;)[2]);
                }

                List&lt;DatasetBean&gt; dsBeans = datahandler.queryDatasetsForFolderStructure(retrievedDatasets);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L446">446</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/ProjectView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/ProjectView.html#L362">362</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }


  VerticalLayout initMemberSection() {
    VerticalLayout projMembers = new VerticalLayout();
    projMembers.setCaption(&quot;Members&quot;);

    membersSection = new VerticalLayout();
    Component membersContent = new VerticalLayout();

    // membersContent.setIcon(FontAwesome.USERS);
    // membersContent.setCaption(&quot;Members&quot;);
    membersSection.addComponent(membersContent);
    // membersSection.setMargin(new MarginInfo(false, false, false, true));
    membersSection.setWidth(&quot;100%&quot;);
    membersSection.setSpacing(true);

    membersSection.setMargin(new MarginInfo(true, false, true, true));
    projMembers.addComponent(membersSection);

    projMembers.setMargin(new MarginInfo(true, false, true, true));
    projMembers.setWidth(&quot;100%&quot;);
    projMembers.setSpacing(true);

    return projMembers;
  }

  void updateContentMemberSection() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/DatasetComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/DatasetComponent.html#L683">683</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/components/LevelComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/LevelComponent.html#L978">978</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/components/ProjInformationComponent.java</td>
<td><a href="./xref/life/qbic/projectbrowser/components/ProjInformationComponent.html#L900">900</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/DatasetView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/DatasetView.html#L631">631</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>                .setValue(prettyNameMapper.getPrettyName(d.getType()));
            dataset_container.getContainerProperty(new_file, &quot;Registration Date&quot;).setValue(ts);
            dataset_container.getContainerProperty(new_file, &quot;Validated&quot;).setValue(true);
            dataset_container.getContainerProperty(new_file, &quot;File Size&quot;)
                .setValue(PortalUtils.humanReadableByteCount(d.getFileSize(), true));
            dataset_container.getContainerProperty(new_file, &quot;dl_link&quot;).setValue(d.getDssPath());
            dataset_container.getContainerProperty(new_file, &quot;CODE&quot;).setValue(d.getCode());
            dataset_container.getContainerProperty(new_file, &quot;file_size_bytes&quot;).setValue(d.getFileSize());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L308">308</a></td></tr>
<tr class="a">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L332">332</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/helpers/CustomVaadinPortlet.java</td>
<td><a href="./xref/life/qbic/projectbrowser/helpers/CustomVaadinPortlet.html#L355">355</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    for (DataSet dataset : datasets) {
      codes.add(dataset.getCode());
    }
    Map&lt;String, List&lt;String&gt;&gt; params = new HashMap&lt;String, List&lt;String&gt;&gt;();
    params.put(&quot;codes&quot;, codes);
    QueryTableModel res = openbisClient.queryFileInformation(params);
    endTime = System.nanoTime();
    LOG.debug(String.format(&quot;getAggregationService took %f s&quot;,
        ((endTime - startTime) / 1000000000.0)));
    download(res, writer, response, openbisClient, bean.getCode());
  }

  void serveExperiment2(ExperimentBean bean, TarWriter writer, ResourceResponse response,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/controllers/DataHandler.java</td>
<td><a href="./xref/life/qbic/projectbrowser/controllers/DataHandler.html#L2351">2351</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/controllers/DataHandler.java</td>
<td><a href="./xref/life/qbic/projectbrowser/controllers/DataHandler.html#L2385">2385</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            testTypes.add(&quot;DNA&quot;);

            String newNGSMeasurementCode = newProjectCode + &quot;E&quot; + numberOfRegisteredExperiments;
            String newNGSMeasurementID =
                &quot;/&quot; + space + &quot;/&quot; + newProjectCode + &quot;/&quot; + newNGSMeasurementCode;
            newNGSMeasurementIDs.add(newNGSMeasurementID);
            numberOfRegisteredExperiments += 1;

            String newNGSRunCode =
                newProjectCode + Utils.createCountString(numberOfRegisteredSamples, 3) + &quot;R&quot;;
            String newNGSRunID =
                &quot;/&quot; + space + &quot;/&quot; + newNGSRunCode + BarcodeFunctions.checksum(newNGSRunCode);
            newNGSRunIDs.add(newNGSRunID);
            numberOfRegisteredSamples += 1;

            additionalInfo.add(false);
            sequencerDevice.add(sampleBean.getSeqDevice());
            parents.add(newTestSampleID);

          }

          if (sampleBean.getRnaSeq()) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/samplegraph/GraphPage.java</td>
<td><a href="./xref/life/qbic/projectbrowser/samplegraph/GraphPage.html#L163">163</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/samplegraph/GraphPage.java</td>
<td><a href="./xref/life/qbic/projectbrowser/samplegraph/GraphPage.html#L187">187</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    for (Sample s : samplesWithData) {
      List&lt;Object&gt; row = new ArrayList&lt;Object&gt;();
      row.add(s.getCode());
      Map&lt;String, String&gt; props = s.getProperties();
      String secName = &quot;&quot;;
      if (props.get(&quot;Q_SECONDARY_NAME&quot;) != null) {
        secName = props.get(&quot;Q_SECONDARY_NAME&quot;);
      }
      row.add(secName);

      String extID = &quot;&quot;;
      if (props.get(&quot;Q_EXTERNALDB_ID&quot;) != null) {
        extID = props.get(&quot;Q_EXTERNALDB_ID&quot;);
      }
      row.add(extID);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/projectbrowser/views/PatientView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/PatientView.html#L1064">1064</a></td></tr>
<tr class="b">
<td>life/qbic/projectbrowser/views/ProjectView.java</td>
<td><a href="./xref/life/qbic/projectbrowser/views/ProjectView.html#L586">586</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    if (graphSectionContent.getComponentCount() == 0
        || !(graphSectionContent.getComponent(0) instanceof Image)) {
      ProgressBar progress = new ProgressBar();
      progress.setIndeterminate(true);
      Label info = new Label(
          &quot;Computing the project graph can take several seconds on big projects. Please be patient.&quot;);
      info.setStyleName(ValoTheme.LABEL_SUCCESS);
      graphSectionContent.removeAllComponents();
      // graphSectionContent.addComponent(info);
      graphSectionContent.addComponent(progress);
      // graphSectionContent.setComponentAlignment(info, Alignment.MIDDLE_CENTER);
      graphSectionContent.setComponentAlignment(progress, Alignment.MIDDLE_CENTER);

      Worker worker = new Worker(getCurrent());
      worker.start();
      UI.getCurrent().setPollInterval(500);
    }
  }</pre></div></td></tr></table></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2019.All rights reserved.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
